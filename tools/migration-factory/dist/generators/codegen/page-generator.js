/**
 * Generates React page component from a CodegenModel.
 * Follows adh-web hook order: store selectors → useState → useCallback → JSX
 */
export const generatePage = (model) => {
    const lines = [];
    const { domain, domainPascal } = model;
    lines.push(`// Page for ${domainPascal} (IDE ${model.programId})`);
    lines.push(`// Auto-generated by Migration Factory v8 - edit after generation`);
    lines.push('');
    // Imports
    const reactHooks = ['useState', 'useCallback'];
    if (model.entities.length > 0) {
        reactHooks.push('useEffect');
    }
    lines.push(`import { ${reactHooks.join(', ')} } from 'react';`);
    lines.push(`import { use${domainPascal}Store } from '@/stores/${domain}Store';`);
    lines.push('');
    // Component
    lines.push(`export const ${domainPascal}Page = () => {`);
    // Store selectors first
    lines.push(`  const isLoading = use${domainPascal}Store((s) => s.isLoading);`);
    lines.push(`  const error = use${domainPascal}Store((s) => s.error);`);
    for (const entity of model.entities) {
        lines.push(`  const ${entity.name}List = use${domainPascal}Store((s) => s.${entity.name}List);`);
    }
    for (const action of model.actions) {
        lines.push(`  const ${action.handlerName} = use${domainPascal}Store((s) => s.${action.handlerName});`);
    }
    if (model.apiCalls.length > 0) {
        lines.push(`  const fetchData = use${domainPascal}Store((s) => s.fetchData);`);
    }
    lines.push('');
    // Local state
    lines.push('  const [selectedId, setSelectedId] = useState<string | null>(null);');
    lines.push('');
    // Callbacks
    for (const action of model.actions) {
        lines.push(`  // TODO: ${action.id} - ${action.description}`);
        lines.push(`  const on${action.handlerName[0].toUpperCase() + action.handlerName.slice(1)} = useCallback(async () => {`);
        lines.push(`    await ${action.handlerName}();`);
        lines.push(`  }, [${action.handlerName}]);`);
        lines.push('');
    }
    // Effect for initial data load
    if (model.apiCalls.length > 0) {
        lines.push('  useEffect(() => {');
        lines.push('    fetchData();');
        lines.push('  }, [fetchData]);');
        lines.push('');
    }
    // JSX
    lines.push('  return (');
    lines.push(`    <div className="p-4">`);
    lines.push(`      <h1 className="text-2xl font-bold mb-4">${domainPascal}</h1>`);
    lines.push('');
    lines.push('      {error && (');
    lines.push('        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">');
    lines.push('          {error}');
    lines.push('        </div>');
    lines.push('      )}');
    lines.push('');
    lines.push('      {isLoading && <p>Chargement...</p>}');
    lines.push('');
    lines.push('      {/* TODO: implement UI */}');
    // Action buttons
    if (model.actions.length > 0) {
        lines.push('      <div className="flex gap-2 mb-4">');
        for (const action of model.actions) {
            const label = action.description.slice(0, 30);
            lines.push(`        <button`);
            lines.push(`          className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"`);
            lines.push(`          onClick={on${action.handlerName[0].toUpperCase() + action.handlerName.slice(1)}}`);
            lines.push(`          disabled={isLoading}`);
            lines.push(`        >`);
            lines.push(`          ${label}`);
            lines.push(`        </button>`);
        }
        lines.push('      </div>');
    }
    lines.push('    </div>');
    lines.push('  );');
    lines.push('};');
    lines.push('');
    return lines.join('\n');
};
//# sourceMappingURL=page-generator.js.map