# ADH IDE 192 - SOLDE_COMPTE
# Programme partage via ADH.ecf - CROSS-PROJECT CALLER
# Utilise par: PBP, PVE

program:
  project: "ADH"
  ide: 192

functional:
  objective:
    who: "Systeme / Programme appelant"
    what: "Calculer le solde d'un compte adherent"
    why: "Fournir le solde actuel pour validation operations ou affichage"

  user_flow:
    - Appel avec parametres (societe, compte, filiation)
    - Lecture operations et totaux par type
    - Calcul solde = SUM(credits) - SUM(debits)
    - Retour valeur solde au programme appelant

  error_cases:
    - condition: Compte sans operations
      message: "Solde = 0 (aucune operation)"
      severity: LOW
    - condition: Erreur lecture tables
      message: "Impossible de calculer le solde"
      severity: HIGH

business_rules:
  - code: RM-001
    description: Solde = somme des credits moins somme des debits
    expression_id: null
    validated: false
  - code: RM-002
    description: Calcul par service si parametre fourni
    expression_id: null
    validated: false
  - code: RM-003
    description: Retour via parametre de sortie (pas d'affichage)
    expression_id: null
    validated: false

migration:
  complexity_override: LOW
  target_architecture: CQRS
  notes:
    - "Fonction utilitaire - pas d'interface"
    - "Query simple sur tables operations et ccpartyp"
    - "Utilise comme sous-routine par de nombreux programmes"
    - "Deja migre: GetSoldeCompteQuery dans API C#"
  test_coverage:
    unit_tests: 80
    integration_tests: true
    regression_patterns: true

dependencies:
  external: []
  ecf_notes: "PARTAGE via ADH.ecf (Sessions_Reprises) - Appele depuis PBP et PVE"

history:
  - date: "2026-01-27"
    author: "Claude"
    change: "Creation annotation initiale - Programme ECF"
    ticket: null
  - date: "2025-12-28"
    author: "Migration"
    change: "Programme migre vers API C# .NET 8 (GetSoldeCompteQuery)"
    ticket: null

metadata:
  author: "Claude"
  created_at: "2026-01-27"
  last_updated: "2026-01-27"
  reviewers: []
  tags:
    - solde
    - ecf-shared
    - cross-project
    - utility
    - migrated
