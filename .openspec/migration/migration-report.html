<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SPECMAP - Migration Dashboard</title>
<style>

:root {
  --bg: #0d1117;
  --card: #161b22;
  --border: #30363d;
  --text: #c9d1d9;
  --text-dim: #8b949e;
  --green: #3fb950;
  --blue: #58a6ff;
  --purple: #bc8cff;
  --yellow: #d29922;
  --orange: #f0883e;
  --red: #f85149;
  --gray: #484f58;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
}

.container { max-width: 1200px; margin: 0 auto; padding: 24px; }

header {
  text-align: center;
  padding: 32px 0 24px;
}
header h1 {
  font-size: 28px;
  font-weight: 600;
  background: linear-gradient(135deg, var(--blue), var(--purple));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.subtitle { color: var(--text-dim); margin-top: 4px; }
.last-updated {
  margin-top: 8px;
  font-size: 13px;
  color: var(--text-dim);
  background: rgba(88,166,255,0.08);
  display: inline-block;
  padding: 4px 16px;
  border-radius: 16px;
  border: 1px solid rgba(88,166,255,0.2);
}

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
}
.card h2 {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text);
  border-bottom: 1px solid var(--border);
  padding-bottom: 8px;
}

/* KPI Grid */
.kpi-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
  margin-bottom: 20px;
}
.kpi-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 20px;
  text-align: center;
}
.kpi-value { font-size: 32px; font-weight: 700; }
.kpi-label { font-size: 14px; color: var(--text-dim); margin-top: 4px; }
.kpi-detail { font-size: 12px; color: var(--text-dim); margin-top: 2px; }

/* Pipeline bars */
.pipeline { display: flex; flex-direction: column; gap: 8px; }
.pipeline-row { display: flex; align-items: center; gap: 12px; }
.pipeline-label { width: 90px; font-size: 13px; color: var(--text-dim); text-align: right; }
.pipeline-count { width: 80px; font-size: 13px; color: var(--text-dim); }
.bar-track {
  flex: 1;
  height: 20px;
  background: var(--bg);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
}
.bar-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s ease;
  position: absolute;
  top: 0;
}
.bar-small { height: 12px; }
.bar-large { height: 28px; border-radius: 6px; }
.bar-verified { background: var(--green); }
.bar-enriched { background: var(--blue); }
.bar-contracted { background: var(--yellow); }

.pipeline-donut-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 32px;
  margin-top: 16px;
}
.donut-container { position: relative; width: 120px; height: 120px; }
.donut { width: 100%; height: 100%; transform: rotate(-90deg); }
.donut-center {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  font-size: 22px;
  font-weight: 700;
  color: var(--green);
}
.legend { display: flex; flex-direction: column; gap: 4px; }
.legend-item { font-size: 13px; display: flex; align-items: center; gap: 6px; }
.legend-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }

/* Modules */
.module-filters {
  display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;
}
.filter-btn {
  padding: 4px 12px;
  border: 1px solid var(--border);
  border-radius: 16px;
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 13px;
}
.filter-btn:hover { border-color: var(--blue); color: var(--blue); }
.filter-btn.active { background: var(--blue); color: #fff; border-color: var(--blue); }

.module-list { display: flex; flex-direction: column; gap: 8px; }
.module-row {
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 12px 16px;
  background: var(--bg);
}
.module-row[data-status="deliverable"] { border-left: 3px solid var(--green); }
.module-row[data-status="close"] { border-left: 3px solid var(--blue); }
.module-row[data-status="progress"] { border-left: 3px solid var(--yellow); }
.module-row[data-status="notstarted"] { border-left: 3px solid var(--gray); }

.module-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.module-name { font-weight: 600; font-size: 14px; }
.module-stats { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
.module-stats span:first-child { width: 70px; font-size: 12px; color: var(--text-dim); }
.module-pct { width: 40px; text-align: right; font-weight: 600; font-size: 13px; }
.module-breakdown { display: flex; gap: 6px; flex-wrap: wrap; }
.module-blockers { font-size: 12px; color: var(--red); margin-top: 4px; }
.module-deps { font-size: 12px; color: var(--text-dim); margin-top: 4px; display: flex; gap: 8px; flex-wrap: wrap; }
.dep-separator { color: var(--border); }

.rank-badge {
  display: inline-block;
  background: var(--purple);
  color: #fff;
  font-size: 11px;
  font-weight: 700;
  padding: 1px 6px;
  border-radius: 4px;
  margin-right: 6px;
}

.module-sort { display: flex; gap: 6px; margin-bottom: 12px; align-items: center; }
.sort-label { font-size: 13px; color: var(--text-dim); }
.sort-btn {
  padding: 2px 10px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 12px;
}
.sort-btn:hover { border-color: var(--purple); color: var(--purple); }
.sort-btn.active { background: var(--purple); color: #fff; border-color: var(--purple); }

/* Migration Waves */
.wave-sequence { display: flex; flex-direction: column; align-items: center; gap: 0; }
.wave-block {
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px 16px;
  background: var(--bg);
  width: 100%;
  max-width: 600px;
}
.wave-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.wave-number { font-weight: 600; font-size: 14px; color: var(--purple); }
.wave-modules { display: flex; gap: 6px; flex-wrap: wrap; }
.wave-chip {
  font-size: 12px;
  padding: 3px 8px;
  border-radius: 4px;
  background: rgba(188,140,255,0.1);
  color: var(--text);
  border: 1px solid rgba(188,140,255,0.3);
}
.wave-arrow { font-size: 20px; color: var(--purple); text-align: center; line-height: 1; padding: 4px 0; }
.complexity-high { background: rgba(248,81,73,0.2); color: var(--red); }
.complexity-med { background: rgba(210,153,34,0.2); color: var(--yellow); }
.complexity-low { background: rgba(63,185,80,0.2); color: var(--green); }

.tag {
  font-size: 11px; padding: 1px 6px; border-radius: 4px; display: inline-block;
}
.tag-red { background: rgba(248,81,73,0.15); color: var(--red); }
.tag-green { background: rgba(63,185,80,0.15); color: var(--green); }
.tag-blue { background: rgba(88,166,255,0.15); color: var(--blue); }
.tag-yellow { background: rgba(210,153,34,0.15); color: var(--yellow); }
.tag-gray { background: rgba(72,79,88,0.3); color: var(--text-dim); }
.tag-purple { background: rgba(139,92,246,0.2); color: #a78bfa; font-weight: 600; }
.tag-teal { background: rgba(20,184,166,0.15); color: #5eead4; }
.tag-orange { background: rgba(249,115,22,0.15); color: #fb923c; }
.tag-dim { background: rgba(72,79,88,0.15); color: var(--text-dim); }

.badge {
  font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 10px;
  display: inline-block; text-transform: uppercase; letter-spacing: 0.5px;
}
.badge-sm { font-size: 10px; padding: 1px 5px; }
.badge-green { background: rgba(63,185,80,0.2); color: var(--green); }
.badge-blue { background: rgba(88,166,255,0.2); color: var(--blue); }
.badge-yellow { background: rgba(210,153,34,0.2); color: var(--yellow); }
.badge-gray { background: rgba(72,79,88,0.3); color: var(--text-dim); }
.badge-purple { background: rgba(188,140,255,0.2); color: var(--purple); }

/* Decommission */
.decommission-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 12px; margin-bottom: 16px;
}
.decom-stat { text-align: center; padding: 12px; border-radius: 6px; background: var(--bg); }
.decom-value { font-size: 28px; font-weight: 700; }
.decom-label { font-size: 12px; color: var(--text-dim); margin-top: 2px; }
.decom-ok { color: var(--green); }
.decom-blocked { color: var(--red); }
.decom-wait { color: var(--orange); }
.decom-shared { color: var(--purple); }
.decom-bar-container { text-align: center; }
.decom-bar-label { font-size: 13px; color: var(--text-dim); margin-top: 6px; }

/* Program table */
.table-controls {
  display: flex; gap: 12px; margin-bottom: 12px; flex-wrap: wrap; align-items: center;
}
.search-input {
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
  font-size: 13px;
  flex: 1;
  min-width: 200px;
}
.filter-select {
  padding: 6px 8px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
  font-size: 13px;
}
.checkbox-label { font-size: 13px; color: var(--text-dim); display: flex; align-items: center; gap: 4px; }

.table-scroll { overflow-x: auto; }
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
th {
  text-align: left;
  padding: 8px 10px;
  border-bottom: 2px solid var(--border);
  color: var(--text-dim);
  font-weight: 600;
  cursor: pointer;
  user-select: none;
}
th:hover { color: var(--blue); }
td { padding: 6px 10px; border-bottom: 1px solid var(--border); }
.center { text-align: center; }

.status-pill {
  font-size: 11px; padding: 2px 8px; border-radius: 10px; font-weight: 500;
}
.status-verified { background: rgba(63,185,80,0.15); color: var(--green); }
.status-enriched { background: rgba(88,166,255,0.15); color: var(--blue); }
.status-contracted { background: rgba(210,153,34,0.15); color: var(--yellow); }
.status-pending { background: rgba(72,79,88,0.3); color: var(--text-dim); }

tr:hover td { background: rgba(88,166,255,0.05); }

/* Grade badge */
.grade-badge {
  display: inline-block;
  color: #fff;
  font-size: 11px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 4px;
  min-width: 24px;
  text-align: center;
}

/* Estimation section */
.estimation-grid {
  display: flex;
  gap: 24px;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 16px;
}
.estimation-kpi {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  flex: 1;
}
.estimation-kpi .kpi-card { flex: 1; min-width: 180px; }
.estimation-donut { flex: 0 0 auto; }
.effort-bar-container { text-align: center; margin-top: 8px; }
.effort-bar-label { font-size: 13px; color: var(--text-dim); margin-top: 6px; }
.no-data { color: var(--text-dim); font-style: italic; padding: 20px; }

footer {
  text-align: center;
  padding: 20px;
  color: var(--text-dim);
  font-size: 12px;
}

@media (max-width: 768px) {
  .kpi-grid { grid-template-columns: repeat(2, 1fr); }
  .decommission-grid { grid-template-columns: repeat(2, 1fr); }
}

/* Documentation tabs */
.doc-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 20px;
  border-bottom: 2px solid var(--border);
  overflow-x: auto;
}
.doc-tab {
  padding: 10px 16px;
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  transition: all 0.2s;
  white-space: nowrap;
  margin-bottom: -2px;
}
.doc-tab:hover {
  color: var(--text);
  background: rgba(88,166,255,0.05);
}
.doc-tab.active {
  color: var(--blue);
  border-bottom-color: var(--blue);
}
.doc-content {
  display: none;
}
.doc-content.active {
  display: block;
}
.doc-content h3 {
  font-size: 18px;
  margin: 20px 0 12px 0;
  color: var(--text);
  border-left: 3px solid var(--blue);
  padding-left: 12px;
}
.doc-content h4 {
  font-size: 15px;
  margin: 16px 0 8px 0;
  color: var(--text);
}
.doc-content p {
  margin: 8px 0;
  line-height: 1.6;
  color: var(--text-dim);
}
.doc-content ul, .doc-content ol {
  margin: 8px 0 8px 20px;
  color: var(--text-dim);
}
.doc-content li {
  margin: 4px 0;
}
.doc-content code {
  background: rgba(88,166,255,0.1);
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 12px;
  color: var(--blue);
  font-family: 'Consolas', 'Monaco', monospace;
}
.doc-content pre {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 12px;
  overflow-x: auto;
  font-size: 12px;
  line-height: 1.5;
  margin: 12px 0;
}
.doc-content pre code {
  background: none;
  padding: 0;
  color: var(--text);
}
.doc-table {
  width: 100%;
  border-collapse: collapse;
  margin: 12px 0;
  font-size: 13px;
}
.doc-table th {
  background: var(--bg);
  padding: 8px 12px;
  text-align: left;
  border-bottom: 2px solid var(--border);
  color: var(--text);
  font-weight: 600;
}
.doc-table td {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border);
  color: var(--text-dim);
}
.doc-table tr:hover {
  background: rgba(88,166,255,0.05);
}
.doc-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}
.doc-badge-blue { background: rgba(88,166,255,0.2); color: var(--blue); }
.doc-badge-green { background: rgba(63,185,80,0.2); color: var(--green); }
.doc-badge-purple { background: rgba(188,140,255,0.2); color: var(--purple); }
.doc-badge-yellow { background: rgba(210,153,34,0.2); color: var(--yellow); }
.doc-badge-orange { background: rgba(240,136,62,0.2); color: var(--orange); }
.doc-highlight {
  background: rgba(88,166,255,0.1);
  border-left: 3px solid var(--blue);
  padding: 12px 16px;
  margin: 12px 0;
  border-radius: 4px;
}
.doc-steps {
  counter-reset: step-counter;
  list-style: none;
  margin-left: 0;
}
.doc-steps > li {
  counter-increment: step-counter;
  position: relative;
  padding-left: 40px;
  margin: 16px 0;
}
.doc-steps > li::before {
  content: counter(step-counter);
  position: absolute;
  left: 0;
  top: 0;
  background: var(--blue);
  color: #fff;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 14px;
}


/* Project Tab Bar */
.project-tabs-bar {
  display: flex;
  gap: 4px;
  margin-bottom: 24px;
  padding: 4px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow-x: auto;
  flex-wrap: wrap;
}
.project-tab {
  padding: 8px 16px;
  border: none;
  border-radius: 8px;
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
  transition: all 0.2s;
}
.project-tab:hover { color: var(--text); background: rgba(88,166,255,0.08); }
.project-tab.active { background: var(--blue); color: #fff; }
.tab-dot {
  width: 8px; height: 8px; border-radius: 50%; display: inline-block;
}
.tab-dot-global { background: var(--purple); }
.tab-dot-active { background: var(--green); }
.tab-dot-planned { background: var(--yellow); }
.tab-dot-idle { background: var(--gray); }

/* Tab Content */
.tab-content { display: none; }
.tab-content.active { display: block; }

/* Project Cards Grid */
.project-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}
.project-card {
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 16px;
  background: var(--bg);
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s;
}
.project-card:hover { border-color: var(--blue); transform: translateY(-2px); }
.project-card-idle { opacity: 0.6; cursor: default; }
.project-card-idle:hover { border-color: var(--border); transform: none; }
.project-card-name { font-size: 18px; font-weight: 700; margin-bottom: 2px; }
.project-card-desc { font-size: 12px; color: var(--text-dim); margin-bottom: 6px; }
.project-card-status { margin-bottom: 8px; }
.project-card-progress { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.project-card-pct { font-weight: 600; font-size: 14px; width: 40px; text-align: right; }
.project-card-stats {
  display: flex; gap: 8px; flex-wrap: wrap; font-size: 11px; color: var(--text-dim);
}
.project-card-stats span {
  padding: 1px 6px;
  background: rgba(72,79,88,0.2);
  border-radius: 4px;
}
.project-card-stat { font-size: 13px; color: var(--text-dim); }

/* Empty project tab */
.empty-project { text-align: center; padding: 60px 20px; }
.empty-icon { font-size: 48px; margin-bottom: 16px; }
.empty-message p { margin-bottom: 8px; }
.empty-detail { color: var(--text-dim); font-size: 14px; }
.empty-hint { color: var(--text-dim); font-size: 12px; margin-top: 16px; }
.empty-hint code {
  background: var(--bg);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 11px;
}

/* Action Bar */
.action-bar {
  display: flex;
  gap: 8px;
  align-items: center;
  padding: 8px 12px;
  margin-bottom: 16px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  flex-wrap: wrap;
}
.server-badge {
  font-size: 11px;
  font-weight: 600;
  padding: 3px 10px;
  border-radius: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.server-badge.connected { background: rgba(63,185,80,0.2); color: var(--green); }
.server-badge.disconnected { background: rgba(72,79,88,0.3); color: var(--text-dim); }
.action-select {
  padding: 5px 8px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
  font-size: 13px;
  min-width: 140px;
}
.action-select:disabled { opacity: 0.5; cursor: not-allowed; }
.action-btn {
  padding: 5px 14px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.15s;
}
.action-btn:hover:not(:disabled) { border-color: var(--blue); color: var(--blue); }
.action-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.action-btn.primary { background: var(--blue); color: #fff; border-color: var(--blue); }
.action-btn.primary:hover:not(:disabled) { background: #4b9cf5; }
.action-btn.primary:disabled { background: var(--gray); border-color: var(--gray); }
.action-panel {
  display: none;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
  max-height: 400px;
  overflow-y: auto;
}
.action-panel.visible { display: block; }
.pipeline-progress { padding: 8px 0; }
.progress-bar { height: 20px; background: #1e293b; border-radius: 4px; overflow: hidden; }
.progress-fill { height: 100%; background: linear-gradient(90deg, #3b82f6, #10b981); width: 0%; transition: width 0.3s; }
.p-status { margin-top: 6px; font-size: 13px; color: #94a3b8; }
.p-log { max-height: 300px; overflow-y: auto; font-size: 12px; margin-top: 8px; }
.p-log > div { padding: 2px 0; border-bottom: 1px solid #1e293b; color: #cbd5e1; }
.action-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.action-panel pre {
  margin: 0;
  white-space: pre-wrap;
  font-size: 12px;
  line-height: 1.5;
  color: var(--text);
}
.action-spinner {
  display: inline-block;
  width: 14px;
  height: 14px;
  border: 2px solid var(--border);
  border-top-color: var(--blue);
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  margin-right: 6px;
  vertical-align: middle;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Migration Panel (bottom-anchored, collapsible) */
.migrate-panel {
  display: none;
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: var(--card);
  border-top: 2px solid var(--blue);
  z-index: 1000;
  flex-direction: column;
  max-height: 50vh;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.5);
  transition: max-height 0.3s ease;
}
.migrate-panel.visible { display: flex; }
.migrate-panel.collapsed { max-height: 42px; }
.migrate-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 16px;
  color: #e2e8f0;
  flex-shrink: 0;
  cursor: pointer;
  background: rgba(0,0,0,0.2);
  user-select: none;
}
.migrate-panel-header strong { font-size: 14px; }
.migrate-badge {
  font-size: 11px;
  padding: 1px 8px;
  border-radius: 10px;
  background: var(--green);
  color: #000;
  font-weight: 600;
}
.migrate-panel-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  padding: 0;
  overflow: hidden;
}
.migrate-panel.collapsed .migrate-panel-body { display: none; }
.mp-section { padding: 6px 16px 2px; flex-shrink: 0; }
.mp-bar-row { display: flex; align-items: center; gap: 8px; }
.mp-bar-track { flex: 1; height: 14px; background: #1e293b; border-radius: 7px; overflow: hidden; }
.mp-bar-fill { height: 100%; border-radius: 7px; transition: width 0.4s ease; }
.mp-bar-module { background: linear-gradient(90deg, #3b82f6, #3fb950); }
.mp-bar-prog { background: #f59e0b; }
.mp-bar-label { font-size: 12px; color: #e2e8f0; white-space: nowrap; min-width: 90px; }
.mp-elapsed { font-size: 11px; color: #8b949e; margin-top: 2px; }
.mp-prog-title { font-size: 12px; color: #e2e8f0; margin-bottom: 3px; font-weight: 600; }
.mp-grid-section { padding: 4px 16px; max-height: 200px; overflow-y: auto; flex-shrink: 0; }
.mp-grid { width: 100%; border-collapse: collapse; font-size: 12px; }
.mp-grid th { text-align: left; color: #8b949e; font-weight: 500; padding: 2px 6px; border-bottom: 1px solid #334155; font-size: 11px; }
.mp-grid td { padding: 3px 6px; color: #cbd5e1; border-bottom: 1px solid #1e293b; }
.mp-grid td:first-child { color: #8b949e; font-variant-numeric: tabular-nums; }
.mp-grid td:nth-child(2) { max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.mp-grid td:nth-child(3) { text-align: center; width: 24px; }
.mp-dur { font-variant-numeric: tabular-nums; color: #8b949e; font-size: 11px; white-space: nowrap; width: 60px; }
.mp-row-active { background: rgba(59,130,246,0.1); }
.mp-row-done td { opacity: 0.6; }
.mp-dots { display: flex; gap: 2px; }
.mp-dot { width: 8px; height: 8px; border-radius: 50%; background: #334155; flex-shrink: 0; }
.mp-dot.done { background: #3fb950; }
.mp-dot.skipped { background: #6b7280; }
.mp-dot.active { background: #f59e0b; animation: mp-pulse 1s ease-in-out infinite; }
.mp-dot.failed { background: #f85149; }
@keyframes mp-pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.4; } }
.mp-pulse-bar { width: 100% !important; animation: mp-pulse 1.5s ease-in-out infinite; }
.mp-log-section { padding: 0 16px 8px; flex: 1; display: flex; flex-direction: column; min-height: 0; }
.mp-log-toggle { font-size: 12px; color: #8b949e; cursor: pointer; padding: 4px 0; user-select: none; }
.mp-log-toggle:hover { color: #e2e8f0; }
.mp-log-arrow { display: inline-block; transition: transform 0.2s; }
.mp-log-section.collapsed .mp-log-arrow { transform: rotate(-90deg); }
.mp-log { flex: 1; overflow-y: auto; font-size: 11px; min-height: 0; max-height: calc(50vh - 280px); }
.mp-log-section.collapsed .mp-log { display: none; }
.mp-log > div { padding: 1px 0; border-bottom: 1px solid #1e293b; color: #94a3b8; }

/* Confirmation Modal */
.modal-backdrop {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.7);
  z-index: 1100;
  justify-content: center;
  align-items: center;
}
.modal-backdrop.visible { display: flex; }
.modal-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  min-width: 400px;
  max-width: 500px;
  color: var(--text);
}
.modal-field {
  margin-bottom: 12px;
}
.modal-field label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-dim);
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.modal-input {
  padding: 6px 10px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
  font-size: 14px;
  width: 100%;
  box-sizing: border-box;
}
.modal-input:focus { border-color: var(--blue); outline: none; }

/* Help Overlay */
.help-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.85);
  z-index: 1200;
  justify-content: center;
  overflow-y: auto;
  padding: 40px 20px;
}
.help-overlay.visible { display: flex; }
.help-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 32px;
  max-width: 700px;
  width: 100%;
  color: var(--text);
  align-self: flex-start;
}
.help-section { margin-bottom: 20px; }
.help-section h3 { font-size: 15px; margin: 0 0 8px 0; color: var(--blue); }
.help-section p { font-size: 13px; line-height: 1.6; margin: 0 0 6px 0; color: #94a3b8; }
.help-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.help-table td { padding: 6px 8px; border-bottom: 1px solid var(--border); color: #94a3b8; }
.help-table td:first-child { white-space: nowrap; width: 140px; }
.help-phases { font-size: 13px; line-height: 1.8; color: #94a3b8; padding-left: 20px; }
.help-phases li { margin-bottom: 2px; }
.help-cli {
  background: var(--bg);
  padding: 12px;
  border-radius: 6px;
  font-size: 12px;
  line-height: 1.6;
  overflow-x: auto;
  color: #94a3b8;
}

</style>
</head>
<body>
<div class="container">

<header>
  <h1>SPECMAP Migration Dashboard</h1>
  <div class="subtitle">29 projets &middot; 1 actif &middot; 212 programmes LIVE</div>
  <div class="last-updated">Dernière mise à jour : 24 février 2026 à 02:35</div>
</header>

<nav class="project-tabs-bar">
  <button class="project-tab active" data-project="global"><span class="tab-dot tab-dot-global"></span>Vue Globale</button>
  <button class="project-tab" data-project="ADH"><span class="tab-dot tab-dot-active"></span>ADH</button>
</nav>

<div class="action-bar" id="action-bar">
  <span class="server-badge disconnected" id="server-badge">Hors ligne</span>
  <select id="batch-select" class="action-select" disabled>
    <option value="">Sélectionner un batch...</option>
  </select>
  <button class="action-btn" id="btn-preflight" disabled title="Lancez 'migration-factory serve' pour activer">Pré-requis</button>
  <button class="action-btn primary" id="btn-run" disabled title="Lancez 'migration-factory serve' pour activer">Lancer Pipeline</button>
  <button class="action-btn" id="btn-verify" disabled title="Lancez 'migration-factory serve' pour activer">Vérifier</button>
  <button class="action-btn" id="btn-gaps" disabled title="Lancez 'migration-factory serve' pour activer">Gaps</button>
  <button class="action-btn" id="btn-calibrate" disabled title="Lancez 'migration-factory serve' pour activer">Calibrer</button>
  <button class="action-btn" id="btn-generate" disabled title="Lancez 'migration-factory serve' pour activer" style="background:#7c3aed;color:#fff">Générer Code</button>
  <button class="action-btn" id="btn-migrate" disabled title="Lancez 'migration-factory serve' pour activer" style="background:#059669;color:#fff">Migrer Module</button>
  <button class="action-btn" id="btn-migrate-auto" disabled title="Lancez 'migration-factory serve' pour activer" style="background:#0d9488;color:#fff">Migration Auto</button>
  <button class="action-btn" id="btn-analyze" disabled title="Lancez 'migration-factory serve' pour activer" style="background:#6366f1;color:#fff">Analyser Projet</button>
  <select id="sel-enrich" disabled title="Enrichment mode" style="padding:4px 8px;border-radius:4px;border:1px solid var(--border);background:var(--card-bg);color:var(--text-main);font-size:12px">
    <option value="none">Sans enrichissement</option>
    <option value="heuristic">Heuristique</option>
    <option value="claude">Claude API</option>
    <option value="claude-cli">Claude CLI</option>
  </select>
  <label style="margin-left:auto;font-size:12px;color:var(--text-dim);display:flex;align-items:center;gap:4px"><input type="checkbox" id="chk-dry" disabled> Simulation</label>
  <button class="action-btn" id="btn-help" style="padding:4px 10px;font-weight:700;font-size:14px;border-radius:50%;min-width:28px" title="Aide &amp; Documentation">?</button>
</div>
<div class="action-panel" id="action-panel">
  <div class="action-panel-header">
    <strong id="panel-title">Résultats</strong>
    <button class="action-btn" id="btn-close" style="padding:2px 8px;font-size:11px">Fermer</button>
  </div>
  <pre id="panel-content"></pre>
</div>

<!-- Migration progress panel (bottom-anchored, collapsible) -->
<div class="migrate-panel" id="migrate-overlay">
  <div class="migrate-panel-header" id="migrate-panel-toggle">
    <strong id="migrate-overlay-title">Migration</strong>
    <div style="display:flex;align-items:center;gap:6px">
      <span id="mp-dry-badge" style="display:none;background:#f59e0b;color:#000;font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px">DRY-RUN</span>
      <span id="migrate-panel-badge" class="migrate-badge" style="display:none"></span>
      <button class="action-btn" id="migrate-overlay-abort" style="display:none;padding:2px 10px;font-size:11px;background:#f85149;color:#fff;border:none;border-radius:4px;cursor:pointer" title="Annuler la migration">Annuler</button>
      <button class="action-btn" id="migrate-overlay-minimize" style="padding:2px 8px;font-size:11px" title="Minimize/Expand">_</button>
      <button class="action-btn" id="migrate-overlay-close" style="padding:2px 8px;font-size:11px" title="Close">X</button>
    </div>
  </div>
  <div class="migrate-panel-body" id="migrate-panel-body">
    <!-- Section 1: Module progress bar -->
    <div class="mp-section">
      <div class="mp-bar-row">
        <div class="mp-bar-track"><div class="mp-bar-fill mp-bar-module" id="mp-module-bar"></div></div>
        <span class="mp-bar-label" id="mp-module-label">0/0 (0%)</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="mp-elapsed" id="mp-elapsed"></div>
        <div class="mp-elapsed" id="mp-tokens" style="color:#d2a8ff"></div>
      </div>
    </div>
    <!-- Section 2: Current program progress bar -->
    <div class="mp-section" id="mp-prog-section" style="display:none">
      <div class="mp-prog-title" id="mp-prog-title"></div>
      <div class="mp-bar-row">
        <div class="mp-bar-track"><div class="mp-bar-fill mp-bar-prog" id="mp-prog-bar"></div></div>
        <span class="mp-bar-label" id="mp-prog-label"></span>
      </div>
    </div>
    <!-- Section 3: Program grid -->
    <div class="mp-grid-section" id="mp-grid-section" style="display:none">
      <table class="mp-grid">
        <thead><tr><th>IDE</th><th>Programme</th><th></th><th>Durée</th><th>Phases</th></tr></thead>
        <tbody id="mp-grid-body"></tbody>
      </table>
    </div>
    <!-- Section 4: Log (collapsible) -->
    <div class="mp-log-section">
      <div class="mp-log-toggle" id="mp-log-toggle"><span class="mp-log-arrow">&#9660;</span> Log</div>
      <div class="mp-log" id="mp-log"></div>
    </div>
  </div>
</div>

<!-- Confirmation modal before migration launch -->
<div class="modal-backdrop" id="migrate-confirm-modal">
  <div class="modal-content">
    <h3 style="margin:0 0 16px 0;font-size:18px">Lancer la migration</h3>
    <div class="modal-field">
      <label>Batch</label>
      <div id="modal-batch-info" style="font-weight:600"></div>
    </div>
    <div class="modal-field">
      <label for="modal-target-dir">Répertoire cible</label>
      <input type="text" id="modal-target-dir" class="modal-input" value="adh-web" placeholder="ex: adh-web">
      <div id="modal-target-resolved" style="font-size:11px;color:#8b949e;margin-top:2px"></div>
    </div>
    <div class="modal-field">
      <label for="modal-parallel">Programmes en parallèle (0 = auto)</label>
      <input type="number" id="modal-parallel" class="modal-input" value="0" min="0" max="8" style="width:80px">
    </div>
    <div class="modal-field">
      <label>Mode Claude</label>
      <div id="modal-claude-mode" style="font-size:13px;color:#8b949e"></div>
    </div>
    <div class="modal-field">
      <label>Simulation</label>
      <div id="modal-dry-run" style="font-size:13px;color:#8b949e"></div>
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:20px">
      <button class="action-btn" id="modal-cancel">Annuler</button>
      <button class="action-btn primary" id="modal-launch" style="background:#059669;border-color:#059669">Lancer la migration</button>
    </div>
  </div>
</div>

<!-- Help overlay -->
<div class="help-overlay" id="help-overlay">
  <div class="help-content">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <h2 style="margin:0;font-size:20px">Migration Factory - Guide</h2>
      <button class="action-btn" id="help-close" style="padding:4px 12px">Fermer</button>
    </div>

    <div class="help-section">
      <h3>Qu'est-ce que c'est ?</h3>
      <p>La <strong>Migration Factory</strong> est un outil de migration de programmes legacy Magic Unipaas vers des applications web modernes React/TypeScript.</p>
      <p>Elle orchestre le pipeline SPECMAP complet : <strong>EXTRACT &rarr; MAP &rarr; GAP &rarr; CONTRACT &rarr; ENRICH &rarr; VERIFY</strong></p>
      <p>Chaque programme Magic correspond à un module fonctionnel (écran, processus, rapport). La migration traite chaque programme individuellement en 16 phases automatisées.</p>
    </div>

    <div class="help-section">
      <h3>Architecture</h3>
      <ul>
        <li>Chaque <strong>programme Magic</strong> = 1 module fonctionnel (écran, process, rapport)</li>
        <li>La migration traite chaque programme <strong>individuellement en 16 phases</strong></li>
        <li>Un <strong>agent Claude CLI</strong> est lancé par programme (ou N en parallèle)</li>
        <li>Les <strong>batches</strong> regroupent les programmes par domaine fonctionnel</li>
        <li>Fichiers générés : types TS, store Zustand, endpoints API, page React, composants, tests</li>
        <li>Après migration : vérification automatique (TSC + tests) + commit git automatique</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>Boutons d'action</h3>
      <table class="help-table">
        <tr><td><strong>Pré-requis</strong></td><td>Vérifier les pré-requis avant de lancer un batch (contrats, dépendances, gaps)</td></tr>
        <tr><td><strong>Lancer Pipeline</strong></td><td>Exécuter le pipeline SPECMAP sur un batch (contrat &rarr; vérification)</td></tr>
        <tr><td><strong>Vérifier</strong></td><td>Auto-vérifier les contrats dont tous les items sont IMPL ou N/A</td></tr>
        <tr><td><strong>Gaps</strong></td><td>Afficher le rapport de gaps consolidé par contrat</td></tr>
        <tr><td><strong>Calibrer</strong></td><td>Recalculer l'estimation heures/point depuis les contrats vérifiés</td></tr>
        <tr><td><strong>Générer Code</strong></td><td>Générer les fichiers React/TS squelette depuis les contrats</td></tr>
        <tr><td><strong>Migrer Module</strong></td><td>Pipeline complet de migration en 16 phases (spec &rarr; code &rarr; test &rarr; review). Ouvre une modale de confirmation.</td></tr>
        <tr><td><strong>Migration Auto</strong></td><td>Identique à Migrer Module mais sans modale (cible: adh-web, parallèle: auto)</td></tr>
        <tr><td><strong>Analyser Projet</strong></td><td>Détecter les modules fonctionnels et estimer l'effort de migration</td></tr>
      </table>
    </div>

    <div class="help-section">
      <h3>Modes d'enrichissement</h3>
      <table class="help-table">
        <tr><td><strong>Sans enrichissement</strong></td><td>Génère uniquement le squelette (types, composants vides)</td></tr>
        <tr><td><strong>Heuristique</strong></td><td>Remplit automatiquement types et valeurs par défaut depuis le contrat</td></tr>
        <tr><td><strong>Claude API</strong></td><td>Utilise l'API Anthropic (nécessite ANTHROPIC_API_KEY) pour enrichir le code via IA</td></tr>
        <tr><td><strong>Claude CLI</strong></td><td>Utilise la commande locale <code>claude --print</code> pour enrichir via IA</td></tr>
      </table>
    </div>

    <div class="help-section">
      <h3>Phases de migration (16)</h3>
      <p>Chaque programme passe par ces 16 phases lors de <strong>Migrer Module</strong> :</p>
      <ol class="help-phases">
        <li><strong>spec</strong> &mdash; Extraction de la spécification depuis le code legacy</li>
        <li><strong>contract</strong> &mdash; Génération du contrat de migration</li>
        <li><strong>analyze</strong> &mdash; Analyse du programme (domaine, complexité, dépendances)</li>
        <li><strong>types</strong> &mdash; Génération des types TypeScript</li>
        <li><strong>store</strong> &mdash; Génération du store Zustand</li>
        <li><strong>api</strong> &mdash; Génération des endpoints API</li>
        <li><strong>page</strong> &mdash; Génération de la page React</li>
        <li><strong>components</strong> &mdash; Génération des composants React</li>
        <li><strong>tests-unit</strong> &mdash; Génération des tests unitaires</li>
        <li><strong>tests-ui</strong> &mdash; Génération des tests UI</li>
        <li><strong>verify-tsc</strong> &mdash; Vérification TypeScript (tsc --noEmit)</li>
        <li><strong>fix-tsc</strong> &mdash; Correction automatique des erreurs TypeScript</li>
        <li><strong>verify-tests</strong> &mdash; Exécution des tests (vitest)</li>
        <li><strong>fix-tests</strong> &mdash; Correction automatique des tests échoués</li>
        <li><strong>integrate</strong> &mdash; Intégration dans le routeur et l'index</li>
        <li><strong>review</strong> &mdash; Revue finale et nettoyage</li>
      </ol>
    </div>

    <div class="help-section">
      <h3>Batches</h3>
      <p>Les batches regroupent les programmes par domaine fonctionnel. Ils sont générés automatiquement par la commande <code>plan</code> :</p>
      <table class="help-table">
        <tr><td><strong>B1</strong></td><td>Ouverture session (8 progs) &mdash; 100% vérifié</td></tr>
        <tr><td><strong>B2</strong></td><td>Caisse (17 progs)</td></tr>
        <tr><td><strong>B3</strong></td><td>General 1/2 (25 progs)</td></tr>
        <tr><td><strong>B4</strong></td><td>General 2/2 (23 progs)</td></tr>
        <tr><td><strong>B5</strong></td><td>Impression (13 progs)</td></tr>
        <tr><td><strong>B6</strong></td><td>Compte (8 progs)</td></tr>
        <tr><td><strong>B7</strong></td><td>Change (10 progs)</td></tr>
        <tr><td><strong>B8</strong></td><td>Stock (3 progs)</td></tr>
        <tr><td><strong>B9</strong></td><td>Ventes (16 progs)</td></tr>
        <tr><td><strong>B10</strong></td><td>Divers (8 progs)</td></tr>
        <tr><td><strong>B11-B18</strong></td><td>Sous-arbres independants (3-18 progs chacun)</td></tr>
      </table>
    </div>

    <div class="help-section">
      <h3>Commandes CLI</h3>
      <pre class="help-cli">migration-factory serve --port 3070 --dir ADH    # Lancer le dashboard
migration-factory report --multi                   # Générer rapport HTML statique
migration-factory pipeline run --batch B2          # Lancer le pipeline SPECMAP
migration-factory migrate --batch B2 --target adh-web  # Migration complete
migration-factory migrate --batch B2 --target adh-web --parallel 0  # auto-parallel (détecte les CPUs)
migration-factory migrate status                   # Voir la progression
migration-factory verify                           # Auto-vérifier les contrats
migration-factory gaps                             # Rapport de gaps
migration-factory calibrate                        # Recalculer les estimations
migration-factory analyze --dir ADH                # Analyser les modules</pre>
    </div>

    <div class="help-section">
      <h3>Reprise et résilience</h3>
      <ul>
        <li>La migration est <strong>reprise automatique</strong> : si interrompue, les programmes déjà générés (10 phases) sont réutilisés sans re-génération</li>
        <li>Les programmes repris apparaissent en <span style="color:#58a6ff">bleu (reprise)</span> dans le panneau de migration</li>
        <li>Le mode d'enrichissement est <strong>mémorisé</strong> entre les sessions (localStorage)</li>
        <li>Vous pouvez <strong>rafraîchir la page (F5)</strong> pendant une migration &mdash; elle se reconnectera automatiquement via SSE</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>Tokens et coûts</h3>
      <ul>
        <li>Les tokens consommés et le coût estimé sont affichés <strong>en temps réel</strong> dans le panneau de migration</li>
        <li>Le coût cumulé de tous les batches est visible dans le <strong>KPI "Tokens IA"</strong> sur la page principale</li>
        <li>Chaque projet affiche aussi son coût cumulé dans les stats de la carte projet</li>
        <li>Tarification : Sonnet $3/M tokens in, $15/M tokens out</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>Conseils</h3>
      <ul>
        <li>Cochez <strong>Simulation</strong> pour simuler sans modifier de fichiers</li>
        <li>Le timer affiche le temps écoulé et une <strong>estimation du temps restant (ETA)</strong> après le 1er programme terminé</li>
        <li>Le nombre d'agents parallèles est auto-déterminé (0=auto) et affiché dans l'en-tête</li>
        <li>Le KPI <strong>Vérifiés</strong> ne compte que les contrats entièrement validés (tous items IMPL/N/A). Les contrats <em>enrichis</em> par migration apparaissent dans le détail</li>
        <li>Après migration, vérifiez toujours le résultat avec <code>tsc --noEmit</code> et <code>vitest run</code></li>
      </ul>
    </div>
  </div>
</div>

<div class="tab-content active" data-tab="global">
  
<section class="kpi-grid">
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--purple)">1/29</div>
    <div class="kpi-label">Projets actifs</div>
    <div class="kpi-detail">28 en attente</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--blue)">212</div>
    <div class="kpi-label">Programmes LIVE</div>
    <div class="kpi-detail">Tous projets confondus</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--green)">19/212</div>
    <div class="kpi-label">Vérifiés</div>
    <div class="kpi-detail">9% (35 enrichis, 0 analysés)</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--yellow)">0</div>
    <div class="kpi-label">Analysés</div>
    <div class="kpi-detail">0 programmes analysés</div>
  </div>
</section>

<section class="card">
  <h2>Pipeline globale</h2>
  <div class="pipeline">
    
    <div class="pipeline-row">
      <span class="pipeline-label">Vérifié</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 9%; background: var(--green)"></div>
      </div>
      <span class="pipeline-count">19 (9%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">Enrichi</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 17%; background: var(--blue)"></div>
      </div>
      <span class="pipeline-count">35 (17%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">Analysé</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 0%; background: var(--yellow)"></div>
      </div>
      <span class="pipeline-count">0 (0%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">En attente</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 75%; background: var(--gray)"></div>
      </div>
      <span class="pipeline-count">158 (75%)</span>
    </div>
  </div>
</section>

<section class="card">
  <h2>Projets</h2>
  <div class="project-cards-grid">
    
      <div class="project-card project-card-active" data-goto="ADH">
        <div class="project-card-name">ADH</div>
        <div class="project-card-desc">Adherents/Caisse</div>
        <div class="project-card-status"><span class="badge badge-blue">EN COURS</span></div>
        <div class="project-card-progress">
          <div class="bar-track bar-small">
            <div class="bar-fill" style="width:9%; background:var(--green)"></div>
          </div>
          <span class="project-card-pct">9%</span>
        </div>
        <div class="project-card-stats">
          <span>212 LIVE</span>
          <span>19 vérifiés</span>
          <span>0 analysés</span>
          <span>18 modules</span>
          
        </div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">CAB</div>
        <div class="project-card-desc">Caisse batch</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">23 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">CAP</div>
        <div class="project-card-desc">Caisse parametres</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">24 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">EXB</div>
        <div class="project-card-desc">Exports batch</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">25 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">EXF</div>
        <div class="project-card-desc">Exports fichiers</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">26 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">EXM</div>
        <div class="project-card-desc">Exports manuels</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">18 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">FIN</div>
        <div class="project-card-desc">Finance</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">16 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">GES</div>
        <div class="project-card-desc">Gestion</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">54 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">Import</div>
        <div class="project-card-desc">Imports donnees</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">454 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">LOG</div>
        <div class="project-card-desc">Logging</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">20 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">MAI</div>
        <div class="project-card-desc">Maintenance</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">60 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">Menu</div>
        <div class="project-card-desc">Menus</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">18 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">NET</div>
        <div class="project-card-desc">Network</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">10 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PBG</div>
        <div class="project-card-desc">Planification/Batch</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">180 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PBP</div>
        <div class="project-card-desc">Editions/Exports</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">242 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PBS</div>
        <div class="project-card-desc">Batch secondaire</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">59 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">POO</div>
        <div class="project-card-desc">Pooling</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">59 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PTR</div>
        <div class="project-card-desc">Pointage</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">27 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PUG</div>
        <div class="project-card-desc">Purge</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">16 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">PVE</div>
        <div class="project-card-desc">Point de Vente/POS</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">160 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">QUA</div>
        <div class="project-card-desc">Qualite</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">22 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">REF</div>
        <div class="project-card-desc">Reference (tables partagees)</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">738 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">REQ</div>
        <div class="project-card-desc">Requetes</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">51 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">RET</div>
        <div class="project-card-desc">Retours</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">12 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">TPE</div>
        <div class="project-card-desc">Terminal paiement</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">3 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">TST</div>
        <div class="project-card-desc">Tests</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">5 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">UTILS</div>
        <div class="project-card-desc">Utilitaires (.NET)</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">2 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">VIL</div>
        <div class="project-card-desc">Village</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">100 programmes</div>
      </div>
      <div class="project-card project-card-idle">
        <div class="project-card-name">WEL</div>
        <div class="project-card-desc">Welcome/Accueil</div>
        <div class="project-card-status"><span class="badge badge-gray">NON DÉMARRÉ</span></div>
        <div class="project-card-stat">68 programmes</div>
      </div>
  </div>
</section>
</div>


<div class="tab-content" data-tab="ADH">
  
<section class="kpi-grid">
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--blue)">212</div>
    <div class="kpi-label">Programmes LIVE</div>
    <div class="kpi-detail">138 orphelins, 28 partages</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--green)">19/212</div>
    <div class="kpi-label">Vérifiés</div>
    <div class="kpi-detail">9% (35 enrichis, 0 analysés)</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--purple)">1/18</div>
    <div class="kpi-label">Modules livrables</div>
    <div class="kpi-detail">6% des modules</div>
  </div>
  
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--orange)">0/212</div>
    <div class="kpi-label">Décommissionnables</div>
    <div class="kpi-detail">0% du legacy</div>
  </div>
  
</section>
  
<section class="card">
  <h2>Pipeline de migration</h2>
  <div class="pipeline">
    
    <div class="pipeline-row">
      <span class="pipeline-label">Vérifié</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 9%; background: var(--green)"></div>
      </div>
      <span class="pipeline-count">19 (9%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">Enrichi</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 17%; background: var(--blue)"></div>
      </div>
      <span class="pipeline-count">35 (17%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">Analysé</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 0%; background: var(--yellow)"></div>
      </div>
      <span class="pipeline-count">0 (0%)</span>
    </div>
    
    <div class="pipeline-row">
      <span class="pipeline-label">En attente</span>
      <div class="bar-track">
        <div class="bar-fill" style="width: 75%; background: var(--gray)"></div>
      </div>
      <span class="pipeline-count">158 (75%)</span>
    </div>
  </div>
  <div class="pipeline-donut-row">
    
    <div class="donut-container">
      <svg viewBox="0 0 100 100" class="donut">
        <circle cx="50" cy="50" r="40" fill="none" stroke="var(--green)" stroke-width="18" stroke-dasharray="22.52462657290795 228.8027857142755" stroke-dashoffset="0" />
        <circle cx="50" cy="50" r="40" fill="none" stroke="var(--blue)" stroke-width="18" stroke-dasharray="41.492733160619906 209.83467912656354" stroke-dashoffset="-22.52462657290795" />
        <circle cx="50" cy="50" r="40" fill="none" stroke="var(--gray)" stroke-width="18" stroke-dasharray="187.31005255365557 64.01735973352788" stroke-dashoffset="-64.01735973352785" />
      </svg>
      <div class="donut-center">9%</div>
    </div>
    <div class="legend"><span class="legend-item"><span class="legend-dot" style="background:var(--green)"></span>Vérifié: 19</span><span class="legend-item"><span class="legend-dot" style="background:var(--blue)"></span>Enrichi: 35</span><span class="legend-item"><span class="legend-dot" style="background:var(--gray)"></span>En attente: 158</span></div>
  </div>
</section>
  
<section class="card">
  <h2>Estimation &amp; Effort</h2>
  <div class="estimation-grid">
    <div class="estimation-kpi">
      
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--purple)">240.6h</div>
    <div class="kpi-label">Effort total</div>
    <div class="kpi-detail">Score moyen: 7</div>
  </div>
      
  <div class="kpi-card">
    <div class="kpi-value" style="color: var(--orange)">215.2h</div>
    <div class="kpi-label">Effort restant</div>
    <div class="kpi-detail">11% terminé</div>
  </div>
    </div>
    <div class="estimation-donut">
      
    <div class="donut-container">
      <svg viewBox="0 0 100 100" class="donut">
        <circle cx="50" cy="50" r="40" fill="none" stroke="var(--blue)" stroke-width="18" stroke-dasharray="17.782599925979962 233.5448123612035" stroke-dashoffset="0" />
        <circle cx="50" cy="50" r="40" fill="none" stroke="var(--green)" stroke-width="18" stroke-dasharray="233.54481236120347 17.78259992597998" stroke-dashoffset="-17.782599925979962" />
      </svg>
      <div class="donut-center">7%</div>
    </div>
    <div class="legend"><span class="legend-item"><span class="legend-dot" style="background:var(--blue)"></span>Grade C: 15</span><span class="legend-item"><span class="legend-dot" style="background:var(--green)"></span>Grade D: 197</span></div>
    </div>
  </div>
  <div class="effort-bar-container">
    <div class="bar-track bar-large">
      <div class="bar-fill" style="width: 11%; background: linear-gradient(90deg, var(--green), var(--blue))"></div>
    </div>
    <div class="effort-bar-label">25.4h terminés / 240.6h total (11%)</div>
  </div>
  
  <h3 style="margin-top:16px;margin-bottom:8px;font-size:14px;color:var(--text-dim)">Top 10 programmes les plus complexes</h3>
  <div class="table-scroll">
    <table>
      <thead><tr>
        <th>ID</th><th>Nom</th><th class="center">Grade</th><th class="center">Score</th><th class="center">Est.</th><th>Statut</th>
      </tr></thead>
      <tbody><tr>
      <td>163</td>
      <td>Menu caisse GM - scroll</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">30</td>
      <td class="center">4.5h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>121</td>
      <td>Gestion caisse</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">29</td>
      <td class="center">4.4h</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
    </tr><tr>
      <td>131</td>
      <td>Fermeture caisse</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">29</td>
      <td class="center">4.4h</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
    </tr><tr>
      <td>122</td>
      <td>Ouverture caisse</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">27</td>
      <td class="center">4.1h</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
    </tr><tr>
      <td>111</td>
      <td>Garantie sur compte</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>112</td>
      <td>Garantie sur compte PMS-584</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>237</td>
      <td>Transaction Nouv vente avec GP</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>238</td>
      <td>Transaction Nouv vente PMS-584</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>316</td>
      <td>Saisie transaction Nouv vente</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr><tr>
      <td>69</td>
      <td>Extrait de compte</td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">22</td>
      <td class="center">3.3h</td>
      <td><span class="status-pill status-pending">en attente</span></td>
    </tr></tbody>
    </table>
  </div>
</section>
  
<section class="card">
  <h2>Modules (1 livrables / 18 total)</h2>
  <div class="module-filters">
    <button class="filter-btn active" data-filter="all">Tous (18)</button>
    <button class="filter-btn" data-filter="deliverable">Livrables (1)</button>
    <button class="filter-btn" data-filter="close">Proches &ge;80% (0)</button>
    <button class="filter-btn" data-filter="progress">En cours (5)</button>
    <button class="filter-btn" data-filter="notstarted">Non démarré (12)</button>
  </div>
  <div class="module-sort">
    <span class="sort-label">Trier par:</span>
    <button class="sort-btn active" data-sort="priority">Priorité</button>
    <button class="sort-btn" data-sort="readiness">Avancement</button>
    <button class="sort-btn" data-sort="name">Nom</button>
  </div>
  <div class="module-list">
    
    <div class="module-row" data-status="deliverable" data-rank="1" data-readiness="100" data-name="Ouverture Session">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P1</span><span class="tag tag-purple">B1</span>Ouverture Session</span>
        <span class="tag tag-teal">Caisse</span>
        <span class="badge badge-green">LIVRABLE</span>
      </div>
      <div class="module-stats">
        <span>8 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 100%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 100%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 100%"></div>
        </div>
        <span class="module-pct">100% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">8 vérifiés</span>
        <span class="tag tag-blue">8 enrichis</span>
        <span class="tag tag-yellow">8 analysés</span>
        <span class="tag tag-gray">0 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="progress" data-rank="2" data-readiness="29" data-name="Caisse">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P2</span><span class="tag tag-purple">B2</span>Caisse</span>
        <span class="tag tag-teal">Caisse</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~25.7h</span>
        <span class="badge badge-yellow">EN COURS</span>
      </div>
      <div class="module-stats">
        <span>17 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 29%"></div>
          <div class="bar-fill bar-enriched" style="width: 71%; left: 29%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 100%"></div>
        </div>
        <span class="module-pct">29% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">5 vérifiés</span>
        <span class="tag tag-blue">17 enrichis</span>
        <span class="tag tag-yellow">17 analysés</span>
        <span class="tag tag-gray">0 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="progress" data-rank="3" data-readiness="8" data-name="General (1/2)">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P3</span><span class="tag tag-purple">B3</span>General (1/2)</span>
        <span class="tag tag-teal">General</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~29.3h</span>
        <span class="badge badge-yellow">EN COURS</span>
      </div>
      <div class="module-stats">
        <span>25 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 8%"></div>
          <div class="bar-fill bar-enriched" style="width: 92%; left: 8%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 100%"></div>
        </div>
        <span class="module-pct">8% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">2 vérifiés</span>
        <span class="tag tag-blue">25 enrichis</span>
        <span class="tag tag-yellow">25 analysés</span>
        <span class="tag tag-gray">0 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="4" data-readiness="0" data-name="General (2/2)">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P4</span><span class="tag tag-purple">B4</span>General (2/2)</span>
        <span class="tag tag-teal">General</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~9.6h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>23 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">23 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="progress" data-rank="5" data-readiness="8" data-name="Impression">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P5</span><span class="tag tag-purple">B5</span>Impression</span>
        <span class="tag tag-teal">Impression</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~17.1h</span>
        <span class="badge badge-yellow">EN COURS</span>
      </div>
      <div class="module-stats">
        <span>13 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 8%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 8%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 8%"></div>
        </div>
        <span class="module-pct">8% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">1 vérifiés</span>
        <span class="tag tag-blue">1 enrichis</span>
        <span class="tag tag-yellow">1 analysés</span>
        <span class="tag tag-gray">12 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="6" data-readiness="0" data-name="Compte">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P6</span><span class="tag tag-purple">B6</span>Compte</span>
        <span class="tag tag-teal">Compte</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~14.6h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>8 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">8 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="progress" data-rank="7" data-readiness="20" data-name="Change">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P7</span><span class="tag tag-purple">B7</span>Change</span>
        <span class="tag tag-teal">Change</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~10h</span>
        <span class="badge badge-yellow">EN COURS</span>
      </div>
      <div class="module-stats">
        <span>10 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 20%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 20%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 20%"></div>
        </div>
        <span class="module-pct">20% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">2 vérifiés</span>
        <span class="tag tag-blue">2 enrichis</span>
        <span class="tag tag-yellow">2 analysés</span>
        <span class="tag tag-gray">8 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="8" data-readiness="0" data-name="Stock">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P8</span><span class="tag tag-purple">B8</span>Stock</span>
        <span class="tag tag-teal">Stock</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~2h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>3 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">3 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="9" data-readiness="0" data-name="Ventes">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P9</span><span class="tag tag-purple">B9</span>Ventes</span>
        <span class="tag tag-teal">Ventes</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~24.9h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>16 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">16 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="progress" data-rank="10" data-readiness="13" data-name="Divers">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P10</span><span class="tag tag-purple">B10</span>Divers</span>
        <span class="tag tag-teal">misc</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~9.7h</span>
        <span class="badge badge-yellow">EN COURS</span>
      </div>
      <div class="module-stats">
        <span>8 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 13%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 13%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 13%"></div>
        </div>
        <span class="module-pct">13% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">1 vérifiés</span>
        <span class="tag tag-blue">1 enrichis</span>
        <span class="tag tag-yellow">1 analysés</span>
        <span class="tag tag-gray">7 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="11" data-readiness="0" data-name="Comptes de depôt">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P11</span><span class="tag tag-purple">B11</span>Comptes de depôt</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~9h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>6 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">6 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="12" data-readiness="0" data-name="Club Med Pass menu">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P12</span><span class="tag tag-purple">B12</span>Club Med Pass menu</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~11.2h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>10 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">10 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="13" data-readiness="0" data-name="Garantie sur compte">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P13</span><span class="tag tag-purple">B13</span>Garantie sur compte</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~10.3h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>8 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">8 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="14" data-readiness="0" data-name="Fusion">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P14</span><span class="tag tag-purple">B14</span>Fusion</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~3.4h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>3 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">3 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="15" data-readiness="0" data-name="Solde Easy Check Out">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P15</span><span class="tag tag-purple">B15</span>Solde Easy Check Out</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~9.6h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>15 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">15 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="16" data-readiness="0" data-name="Factures (Tble Compta&amp;Vent) V3">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P16</span><span class="tag tag-purple">B16</span>Factures (Tble Compta&amp;Vent) V3</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~4.4h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>6 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">6 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="17" data-readiness="0" data-name="Start">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P17</span><span class="tag tag-purple">B17</span>Start</span>
        <span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~3.2h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>6 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">6 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
    <div class="module-row" data-status="notstarted" data-rank="18" data-readiness="0" data-name="Miscellaneous">
      <div class="module-header">
        <span class="module-name"><span class="rank-badge">P18</span><span class="tag tag-purple">B18</span>Miscellaneous</span>
        <span class="tag tag-teal">misc</span><span class="tag tag-green">Complexité D</span><span class="tag tag-dim">~15.3h</span>
        <span class="badge badge-gray">NON DÉMARRÉ</span>
      </div>
      <div class="module-stats">
        <span>18 progs</span>
        <div class="bar-track bar-small">
          <div class="bar-fill bar-verified" style="width: 0%"></div>
          <div class="bar-fill bar-enriched" style="width: 0%; left: 0%"></div>
          <div class="bar-fill bar-contracted" style="width: 0%; left: 0%"></div>
        </div>
        <span class="module-pct">0% vérifié</span>
      </div>
      <div class="module-breakdown">
        <span class="tag tag-green">0 vérifiés</span>
        <span class="tag tag-blue">0 enrichis</span>
        <span class="tag tag-yellow">0 analysés</span>
        <span class="tag tag-gray">18 en attente</span>
      </div>
      <div class="module-deps">
        <span>Débloque: 0 modules</span>
        <span class="dep-separator">&middot;</span>
        <span>Dépend de: (aucun)</span>
      </div>
      
    </div>
  </div>
</section>
  
<section class="card">
  <h2>Séquence de migration</h2>
  <div class="wave-sequence">
    
      <div class="wave-block">
        <div class="wave-header">
          <span class="wave-number">Wave 1</span>
          <span class="badge complexity-high">HIGH</span>
        </div>
        <div class="wave-modules"><span class="wave-chip">281 Caisse</span><span class="wave-chip">1 1</span><span class="wave-chip">53 53</span><span class="wave-chip">64 Solde Easy Check Out</span><span class="wave-chip">192 192</span><span class="wave-chip">210 210</span><span class="wave-chip">229 229</span></div>
      </div>
      
  </div>
</section>
  
<section class="card">
  <h2>Decommissionnement Legacy</h2>
  <div class="decommission-grid">
    <div class="decom-stat">
      <div class="decom-value decom-ok">0</div>
      <div class="decom-label">Décommissionnables</div>
    </div>
    <div class="decom-stat">
      <div class="decom-value decom-blocked">193</div>
      <div class="decom-label">Bloqués (non migrés)</div>
    </div>
    <div class="decom-stat">
      <div class="decom-value decom-wait">19</div>
      <div class="decom-label">Migrés mais callers actifs</div>
    </div>
    <div class="decom-stat">
      <div class="decom-value decom-shared">1</div>
      <div class="decom-label">Partagés bloqués</div>
    </div>
  </div>
  <div class="decom-bar-container">
    <div class="bar-track bar-large">
      <div class="bar-fill" style="width: 0%; background: var(--green)"></div>
    </div>
    <div class="decom-bar-label">0% du legacy décommissionnable (0/212)</div>
  </div>
</section>
  
<section class="card">
  <h2>Programmes (212)</h2>
  <div class="table-controls">
    <input type="text" id="prog-search" placeholder="Rechercher par nom ou ID..." class="search-input">
    <select id="status-filter" class="filter-select">
      <option value="">Tous les statuts</option>
      <option value="verified">Vérifié</option>
      <option value="enriched">Enrichi</option>
      <option value="contracted">Analysé</option>
      <option value="pending">En attente</option>
    </select>
    <label class="checkbox-label"><input type="checkbox" id="decom-only"> Décommissionnables uniquement</label>
  </div>
  <div class="table-scroll">
    <table id="program-table">
      <thead>
        <tr>
          <th data-sort="id">ID</th>
          <th data-sort="name">Nom</th>
          <th data-sort="level" class="center">Niveau</th>
          <th data-sort="status">Statut</th>
          <th data-sort="grade" class="center">Grade</th>
          <th data-sort="score" class="center">Score</th>
          <th data-sort="est" class="center">Est.</th>
          <th class="center">Tags</th>
          <th data-sort="domain">Domaine</th>
        </tr>
      </thead>
      <tbody>
        <tr class="status-pending">
      <td>1</td>
      <td>Main Program</td>
      <td class="center">8</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">17</td>
      <td class="center">2.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>163</td>
      <td>Menu caisse GM - scroll</td>
      <td class="center">7</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">30</td>
      <td class="center">4.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>281</td>
      <td>Fermeture Sessions</td>
      <td class="center">7</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>121</td>
      <td>Gestion caisse</td>
      <td class="center">6</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">29</td>
      <td class="center">4.4h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>122</td>
      <td>Ouverture caisse</td>
      <td class="center">6</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">27</td>
      <td class="center">4.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>131</td>
      <td>Fermeture caisse</td>
      <td class="center">6</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">29</td>
      <td class="center">4.4h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>155</td>
      <td>Controle fermeture caisse WS</td>
      <td class="center">6</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">15</td>
      <td class="center">2.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>156</td>
      <td>Verif session caisse ouverte2</td>
      <td class="center">6</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>37</td>
      <td>Menu changement compte</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>40</td>
      <td>Comptes de depôt</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">20</td>
      <td class="center">3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>77</td>
      <td>Club Med Pass menu</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">21</td>
      <td class="center">3.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>78</td>
      <td>Print Ventes Club Med Pass</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>111</td>
      <td>Garantie sur compte</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>112</td>
      <td>Garantie sur compte PMS-584</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>119</td>
      <td>Affichage sessions</td>
      <td class="center">5</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>151</td>
      <td>Reimpression tickets fermeture</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>154</td>
      <td>Tableau recap fermeture</td>
      <td class="center">5</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">16</td>
      <td class="center">2.4h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>168</td>
      <td>Gratuités</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>169</td>
      <td>Messages</td>
      <td class="center">5</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>28</td>
      <td>Fusion</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">20</td>
      <td class="center">3h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>39</td>
      <td>Print extrait ObjDevSce</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>53</td>
      <td>Extrait Easy Check Out à J+1</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>64</td>
      <td>Solde Easy Check Out</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">13</td>
      <td class="center">2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>79</td>
      <td>Balance Credit de conso</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>82</td>
      <td>Select affilies</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>86</td>
      <td>Bar Limit</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">13</td>
      <td class="center">2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>97</td>
      <td>Factures (Tble Compta&amp;Vent) V3</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">22</td>
      <td class="center">3.3h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>109</td>
      <td>Print creation garantie TIK V1</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>110</td>
      <td>Print creation garanti PMS-584</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>117</td>
      <td>Historique session</td>
      <td class="center">4</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>120</td>
      <td>Saisie contenu caisse</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">13</td>
      <td class="center">2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>123</td>
      <td>Apport coffre</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>124</td>
      <td>Apport articles</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>125</td>
      <td>Remise en caisse</td>
      <td class="center">4</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>129</td>
      <td>Ecart ouverture caisse</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>130</td>
      <td>Ecart fermeture caisse</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>132</td>
      <td>Historique session</td>
      <td class="center">4</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>137</td>
      <td>Ticket ouverture session</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>138</td>
      <td>Ticket fermeture session</td>
      <td class="center">4</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>139</td>
      <td>Ticket appro remise</td>
      <td class="center">4</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">14</td>
      <td class="center">2.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>158</td>
      <td>Menu Great Member</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>165</td>
      <td>Saisies cautions</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>167</td>
      <td>Liste des affiliés</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>170</td>
      <td>Messagerie</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>172</td>
      <td>Print Depot Obj/Dev/Sce</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>256</td>
      <td>Zoom sur table des gratuites</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>262</td>
      <td>Zoom  des types d'objets</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>263</td>
      <td>Zoom modes de paiement</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>266</td>
      <td>Zoom des all devises</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>267</td>
      <td>Zoom devises</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>268</td>
      <td>Zoom type depot garantie</td>
      <td class="center">4</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>22</td>
      <td>Calcul equivalent</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>23</td>
      <td>Print reçu change achat</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>24</td>
      <td>Print reçu change vente</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>25</td>
      <td>Change GM</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">21</td>
      <td class="center">3.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>27</td>
      <td>Separation</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">17</td>
      <td class="center">2.6h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>36</td>
      <td>Print Separation ou fusion</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>43</td>
      <td>Recuperation du titre</td>
      <td class="center">3</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">15</td>
      <td class="center">2.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>44</td>
      <td>Appel programme</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">16</td>
      <td class="center">2.4h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>68</td>
      <td>Saisie date</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>69</td>
      <td>Extrait de compte</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">22</td>
      <td class="center">3.3h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>70</td>
      <td>Print extrait compte /Nom</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>71</td>
      <td>Print extrait compte /Date</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>72</td>
      <td>Print extrait compte /Cum</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>73</td>
      <td>Print extrait compte /Imp</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>74</td>
      <td>Print extrait DateImp /O</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>76</td>
      <td>Print extrait compte /Service</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>107</td>
      <td>Print creation garantie</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>108</td>
      <td>Print annulation garantie</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>150</td>
      <td>Print comptage WS</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>152</td>
      <td>Recup Classe et Lib du MOP</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">15</td>
      <td class="center">2.3h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>171</td>
      <td>Print versement retrait</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>173</td>
      <td>Facturation appel</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">14</td>
      <td class="center">2.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>174</td>
      <td>Facturation appel</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">16</td>
      <td class="center">2.4h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>175</td>
      <td>Facturation appel</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">12</td>
      <td class="center">1.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>176</td>
      <td>Facturation appel</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>179</td>
      <td>Set Village Address</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>180</td>
      <td>Printer choice</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">16</td>
      <td class="center">2.4h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>181</td>
      <td>Set Listing Number</td>
      <td class="center">3</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>182</td>
      <td>Raz Current Printer</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">13</td>
      <td class="center">2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>183</td>
      <td>Raz Current Printer</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>185</td>
      <td>Chained Listing Printer Choice</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>208</td>
      <td>Print Reçu code autocom</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">8</td>
      <td class="center">1.2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>226</td>
      <td>Recherche Adresse Mail</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>234</td>
      <td>Print ticket vente</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>235</td>
      <td>Print ticket vente LEX</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>236</td>
      <td>Print ticket vente PMS-584</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">9</td>
      <td class="center">1.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>237</td>
      <td>Transaction Nouv vente avec GP</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>238</td>
      <td>Transaction Nouv vente PMS-584</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>239</td>
      <td>Transaction Nouv vente PMS-721</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">10</td>
      <td class="center">1.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>240</td>
      <td>Transaction Nouv vente PMS-710</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>242</td>
      <td>Menu Choix Saisie/Annul vente</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">16</td>
      <td class="center">2.4h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>243</td>
      <td>Histo ventes payantes</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">13</td>
      <td class="center">2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>244</td>
      <td>Histo ventes payantes /PMS-605</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>245</td>
      <td>Histo ventes payantes /PMS-623</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>247</td>
      <td>Deversement Transaction</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">14</td>
      <td class="center">2.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>249</td>
      <td>Reinit Aff PYR</td>
      <td class="center">3</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>253</td>
      <td>Histo ventes Gratuités</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>257</td>
      <td>Zoom articles</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>258</td>
      <td>Zoom mode paiement change GM</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>261</td>
      <td>Zoom des types de taux</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>265</td>
      <td>Zoom devise</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>269</td>
      <td>Zoom services village</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>270</td>
      <td>Zoom sur modes de paiement a/v</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>272</td>
      <td>Zoom modes de paiement</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>275</td>
      <td>Zoom mode de paiement TPE</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>296</td>
      <td>Print versement/retrait bi</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>316</td>
      <td>Saisie transaction Nouv vente</td>
      <td class="center">3</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--blue)">C</span></td>
      <td class="center">25</td>
      <td class="center">3.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>7</td>
      <td>Menu Data Catching</td>
      <td class="center">2</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">15</td>
      <td class="center">2.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>10</td>
      <td>Print list Checkout (shift F9)</td>
      <td class="center">2</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>17</td>
      <td>Print C/O confirmation</td>
      <td class="center">2</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>18</td>
      <td>Print extrait compte</td>
      <td class="center">2</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>166</td>
      <td>Start</td>
      <td class="center">2</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">11</td>
      <td class="center">1.7h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>5</td>
      <td>Alimentation Combos NATION P</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>12</td>
      <td>Catching stats</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">5</td>
      <td class="center">0.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>54</td>
      <td>Factures_Check_Out</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">18</td>
      <td class="center">2.7h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>87</td>
      <td>Print Plafonds alloués</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>91</td>
      <td>Verif boutique</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>126</td>
      <td>Calcul solde initial WS</td>
      <td class="center">1</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">5</td>
      <td class="center">0.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>127</td>
      <td>Calcul solde ouverture WS</td>
      <td class="center">1</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">5</td>
      <td class="center">0.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>224</td>
      <td>Alimentation Combos LIEU SEJ</td>
      <td class="center">1</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>6</td>
      <td>Suppression Carac interdit</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>8</td>
      <td>Set Village info</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>9</td>
      <td>System avail (top left corner</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>11</td>
      <td>Export - address</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>13</td>
      <td>calculate week #</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>14</td>
      <td>e-mail list</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>15</td>
      <td>keyboard</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>16</td>
      <td>Browse - Countries iso</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>19</td>
      <td>Program_19</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>20</td>
      <td>Definition monnaie</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>21</td>
      <td>Recupere devise local</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">7</td>
      <td class="center">1.1h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>29</td>
      <td>Write histo Fus_Sep</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>30</td>
      <td>Read histo Fus_Sep_Det</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>31</td>
      <td>Write histo_Fus_Sep_Det</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>32</td>
      <td>Write histo_Fus_Sep_Saisie</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>33</td>
      <td>Delete histo_Fus_Sep_Saisie</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>34</td>
      <td>Read histo_Fus_Sep_Log</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>35</td>
      <td>Write histo_Fus_Sep_Log</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>42</td>
      <td>Controle Login Informaticien</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>45</td>
      <td>Recuperation langue</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>47</td>
      <td>Date/Heure session user</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>48</td>
      <td>Contrôles - Integrite dates</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>50</td>
      <td>Initialistaion Easy Arrival</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>51</td>
      <td>Recherche Droit Solde Free Ext</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>52</td>
      <td>Creation adresse_village</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>57</td>
      <td>Factures_Sejour</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>58</td>
      <td>Incremente N° de Facture</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>59</td>
      <td>Facture - chargement boutique</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>60</td>
      <td>Creation entete facture</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>61</td>
      <td>Maj des lignes saisies</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>62</td>
      <td>Maj Hebergement Tempo</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>65</td>
      <td>Edition &amp; Mail Easy Check Out</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>75</td>
      <td>Creation Pied Facture</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>80</td>
      <td>Card scan read</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>81</td>
      <td>Card scan create</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>83</td>
      <td>Deactivate all cards</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>84</td>
      <td>SP Caractères Interdits</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>90</td>
      <td>Edition Facture Tva(Compta&amp;Ve)</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>92</td>
      <td>flag ligne boutique</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>93</td>
      <td>Creation Pied Facture</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>95</td>
      <td>Facture - Sejour archive</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>98</td>
      <td>EditFactureTva(Compta&amp;Ve) V3</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>101</td>
      <td>Creation Pied Facture V3</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>104</td>
      <td>Maj Hebergement Tempo V3</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>105</td>
      <td>Maj des lignes saisies V3</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>106</td>
      <td>Maj lignes saisies archive V3</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>113</td>
      <td>Test Activation ECO</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>114</td>
      <td>Club Med Pass Filiations</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>116</td>
      <td>Calcul concurrence sessions</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>118</td>
      <td>Sessions ouvertes WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>128</td>
      <td>Controle ouverture caisse WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>133</td>
      <td>Mise a jour comptage caisse WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>134</td>
      <td>Mise à jour detail session WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>135</td>
      <td>Generation tableau recap WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>136</td>
      <td>Generation ticket WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>140</td>
      <td>Init apport article session WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>141</td>
      <td>Init devise session WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>142</td>
      <td>Devise update session WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">6</td>
      <td class="center">0.9h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>143</td>
      <td>Devises calcul ecart WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>144</td>
      <td>Devises finales F/F Nbre WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>145</td>
      <td>Devises finales F/F Qte WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">4</td>
      <td class="center">0.6h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>146</td>
      <td>Devises tableau recap WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>147</td>
      <td>Devises des tickets WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">5</td>
      <td class="center">0.8h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-verified">
      <td>148</td>
      <td>Devises RAZ WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-verified">vérifié</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">3</td>
      <td class="center">0.5h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>149</td>
      <td>Calcul stock produit WS</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">5</td>
      <td class="center">0.8h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>153</td>
      <td>Calcul du stock devise</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">2</td>
      <td class="center">0.3h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>162</td>
      <td>Selection filiations</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>164</td>
      <td>Operation durant Cloture</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>178</td>
      <td>Set Village Address</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>184</td>
      <td>Get Printer for chained list</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>186</td>
      <td>Get Printer for chained list</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>192</td>
      <td>Calcul si depôt existe</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>200</td>
      <td>Verification si client/serveur</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>210</td>
      <td>Changement de chambre</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>221</td>
      <td>Verif automatic pooling Tic</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>223</td>
      <td>Suppression Carac interdit</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>225</td>
      <td>Get Fidelisation et Remise</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>227</td>
      <td>Get Matricule</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>228</td>
      <td>Gestion Chèque</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>229</td>
      <td>Ventilation Lignes Ventes</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"><span class="badge badge-purple badge-sm">ECF</span></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>231</td>
      <td>Raisons utilisation ADH</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>232</td>
      <td>Verif session caisse ouverte</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>233</td>
      <td>Appel Print ticket vente PMS28</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>241</td>
      <td>Solde Gift Pass</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>248</td>
      <td>Choix PYR (plusieurs chambres)</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>251</td>
      <td>Creation pied Ticket</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>252</td>
      <td>Histo ventes IGR</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-enriched">
      <td>254</td>
      <td>Solde Resort Credit</td>
      <td class="center">0</td>
      <td><span class="status-pill status-enriched">enrichi</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>274</td>
      <td>Zoom Logements</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>277</td>
      <td>Selection Vols /t Ville à côté</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
<tr class="status-pending">
      <td>278</td>
      <td>Zoom Pays Vente</td>
      <td class="center">0</td>
      <td><span class="status-pill status-pending">en attente</span></td>
      <td class="center"><span class="grade-badge" style="background:var(--green)">D</span></td>
      <td class="center">1</td>
      <td class="center">0.2h</td>
      <td class="center"></td>
      <td></td>
    </tr>
      </tbody>
    </table>
  </div>
</section>
</div>


<section class="card" id="documentation-section">
  <h2>📚 Documentation</h2>

  <div class="doc-tabs">
    <button class="doc-tab active" data-doc-tab="architecture">Architecture</button>
    <button class="doc-tab" data-doc-tab="workflow">Workflow</button>
    <button class="doc-tab" data-doc-tab="spec-pipeline">Spec Pipeline</button>
    <button class="doc-tab" data-doc-tab="specmap">SPECMAP</button>
    <button class="doc-tab" data-doc-tab="packages">Packages</button>
    <button class="doc-tab" data-doc-tab="commands">Commandes</button>
    <button class="doc-tab" data-doc-tab="glossary">Glossaire</button>
  </div>

  <!-- TAB: Architecture -->
  <div class="doc-content active" data-doc-content="architecture">
    <h3>🏗️ Architecture globale</h3>
    <p>Le système de migration Magic Unipaas est composé de 5 packages principaux qui travaillent ensemble pour automatiser la migration des programmes legacy vers des applications web modernes.</p>

    <h4>Composants principaux</h4>
    <table class="doc-table">
      <thead>
        <tr>
          <th>Package</th>
          <th>Technologie</th>
          <th>Rôle</th>
          <th>Statut</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>spec-pipeline-v72</strong></td>
          <td>PowerShell + MCP</td>
          <td>Génère automatiquement les specs depuis les XML Magic (5 phases)</td>
          <td><span class="doc-badge doc-badge-green">Prod</span></td>
        </tr>
        <tr>
          <td><strong>parser</strong></td>
          <td>TypeScript</td>
          <td>Parse les expressions Magic → AST → TypeScript/C#/Python</td>
          <td><span class="doc-badge doc-badge-green">Stable</span></td>
        </tr>
        <tr>
          <td><strong>factory-cli</strong></td>
          <td>TypeScript</td>
          <td>Pipeline SPECMAP (CONTRACT → ENRICH → VERIFY)</td>
          <td><span class="doc-badge doc-badge-blue">Dev</span></td>
        </tr>
        <tr>
          <td><strong>adh-web</strong></td>
          <td>React 19 + Vite</td>
          <td>Application web migrée (système Caisse)</td>
          <td><span class="doc-badge doc-badge-yellow">Migration</span></td>
        </tr>
        <tr>
          <td><strong>specmap-dashboard</strong></td>
          <td>HTML statique</td>
          <td>Dashboard de progression multi-projets</td>
          <td><span class="doc-badge doc-badge-green">Prod</span></td>
        </tr>
      </tbody>
    </table>

    <h4>Structure des données</h4>
    <div class="doc-highlight">
      <strong>📁 .openspec/</strong> - Dossier central de spécifications
      <ul style="margin-top: 8px;">
        <li><code>specs/</code> - Specs enrichies (212 programmes ADH)</li>
        <li><code>migration/</code> - Données SPECMAP (contracts, live-programs.json)</li>
        <li><code>tickets/</code> - Tickets Jira liés (CMDS-XXX, PMS-XXX)</li>
        <li><code>pipeline-output/</code> - Sorties brutes du spec-pipeline</li>
      </ul>
    </div>
  </div>

  <!-- TAB: Workflow -->
  <div class="doc-content" data-doc-content="workflow">
    <h3>🔄 Workflow complet de migration</h3>
    <p>Le processus de migration suit 4 grandes étapes, de l'analyse du XML Magic jusqu'au code migré vérifié.</p>

    <ol class="doc-steps">
      <li>
        <strong>Génération de la spec</strong>
        <p>Le spec-pipeline analyse le fichier XML Magic et génère une spécification structurée.</p>
        <pre><code>powershell -File tools/spec-pipeline-v72/Run-SpecPipeline.ps1 -Project ADH -IdePosition 237</code></pre>
        <p>Résultat : <code>.openspec/specs/ADH-IDE-237.md</code> (10-50 KB)</p>
      </li>

      <li>
        <strong>Enrichissement par Claude</strong>
        <p>Claude Code analyse la spec et enrichit la section fonctionnelle + génère l'algorigramme métier.</p>
        <pre><code>/spec-pipeline ADH 237</code></pre>
        <p>Améliore : description fonctionnelle par domaines + diagramme Mermaid</p>
      </li>

      <li>
        <strong>Migration SPECMAP</strong>
        <p>Le factory-cli orchestre la migration en 3 phases : CONTRACT → ENRICH → VERIFY</p>
        <pre><code>pnpm --filter @magic-migration/factory contract ADH 237
pnpm --filter @magic-migration/factory enrich ADH 237
pnpm --filter @magic-migration/factory verify ADH 237</code></pre>
      </li>

      <li>
        <strong>Intégration dans adh-web</strong>
        <p>Le code TypeScript généré est intégré dans l'application React (pages, components, stores).</p>
        <pre><code>pnpm --filter @magic-migration/adh-web dev</code></pre>
      </li>
    </ol>

    <h4>États des programmes</h4>
    <table class="doc-table">
      <thead>
        <tr>
          <th>État</th>
          <th>Description</th>
          <th>Prochaine action</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="doc-badge doc-badge-yellow">PENDING</span></td>
          <td>Spec générée, pas encore contractée</td>
          <td><code>factory contract</code></td>
        </tr>
        <tr>
          <td><span class="doc-badge doc-badge-orange">CONTRACTED</span></td>
          <td>Contract YAML créé, prêt pour enrichissement</td>
          <td><code>factory enrich</code></td>
        </tr>
        <tr>
          <td><span class="doc-badge doc-badge-blue">ENRICHED</span></td>
          <td>Code TypeScript généré, à vérifier</td>
          <td><code>factory verify</code></td>
        </tr>
        <tr>
          <td><span class="doc-badge doc-badge-green">VERIFIED</span></td>
          <td>Implémentation validée et testée</td>
          <td>Prêt pour déploiement</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- TAB: Spec Pipeline -->
  <div class="doc-content" data-doc-content="spec-pipeline">
    <h3>📝 Spec Pipeline V7.2</h3>
    <p>Le spec-pipeline est un ensemble de scripts PowerShell qui analysent les fichiers XML Magic et génèrent automatiquement des spécifications structurées.</p>

    <h4>Les 5 phases d'analyse</h4>
    <table class="doc-table">
      <thead>
        <tr>
          <th>Phase</th>
          <th>Script</th>
          <th>Fonction</th>
          <th>Sortie</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>1. Discovery</strong></td>
          <td>Phase1-Discovery.ps1</td>
          <td>Analyse la structure du programme (tâches, tables, variables)</td>
          <td>structure.json</td>
        </tr>
        <tr>
          <td><strong>2. Mapping</strong></td>
          <td>Phase2-Mapping.ps1</td>
          <td>Résout les callers/callees, dépendances cross-projet</td>
          <td>mapping.json</td>
        </tr>
        <tr>
          <td><strong>3. Decode</strong></td>
          <td>Phase3-Decode.ps1</td>
          <td>Décode les expressions Magic via MCP (magic_decode_expression)</td>
          <td>decoded.json</td>
        </tr>
        <tr>
          <td><strong>4. UI Forms</strong></td>
          <td>Phase4-UIForms.ps1</td>
          <td>Analyse les écrans et formulaires (DataView, colonnes visibles)</td>
          <td>forms.json</td>
        </tr>
        <tr>
          <td><strong>5. Synthesis</strong></td>
          <td>Phase5-Synthesis.ps1</td>
          <td>Génère le fichier .md final (format 3 onglets)</td>
          <td>ADH-IDE-237.md</td>
        </tr>
      </tbody>
    </table>

    <h4>Utilisation</h4>
    <pre><code># Générer une spec complète
powershell -File tools/spec-pipeline-v72/Run-SpecPipeline.ps1 \
  -Project ADH \
  -IdePosition 237

# Batch - régénérer toutes les specs ADH
powershell -File tools/spec-pipeline-v72/Run-BatchADH.ps1

# Enrichir avec Claude (section 2 + algorigramme)
/spec-pipeline ADH 237</code></pre>
  </div>

  <!-- TAB: SPECMAP -->
  <div class="doc-content" data-doc-content="specmap">
    <h3>🎯 SPECMAP - Pipeline de migration</h3>
    <p>SPECMAP (Specification Mapping) est la méthodologie qui transforme les specs enrichies en code moderne vérifié. Le factory-cli implémente ce pipeline en 3 phases.</p>

    <h4>Les 3 phases SPECMAP</h4>
    <table class="doc-table">
      <thead>
        <tr>
          <th>Phase</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>CONTRACT</strong></td>
          <td>Analyse spec + code cible, classifie les éléments (IMPL/PARTIAL/MISSING/N/A), génère contract YAML</td>
        </tr>
        <tr>
          <td><strong>ENRICH</strong></td>
          <td>Génère le code manquant (React pages, Zustand stores, tests Vitest) selon le contract</td>
        </tr>
        <tr>
          <td><strong>VERIFY</strong></td>
          <td>Compare spec vs implémentation, exécute les tests, vérifie la fidélité</td>
        </tr>
      </tbody>
    </table>

    <h4>Commandes factory-cli</h4>
    <table class="doc-table">
      <thead>
        <tr>
          <th>Commande</th>
          <th>Description</th>
          <th>Exemple</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>contract</code></td>
          <td>Analyse spec + code, génère contract YAML</td>
          <td><code>factory contract ADH 237</code></td>
        </tr>
        <tr>
          <td><code>enrich</code></td>
          <td>Génère le code manquant selon contract</td>
          <td><code>factory enrich ADH 237 --mode heuristic</code></td>
        </tr>
        <tr>
          <td><code>verify</code></td>
          <td>Vérifie fidélité spec ↔ code</td>
          <td><code>factory verify ADH 237</code></td>
        </tr>
        <tr>
          <td><code>modules</code></td>
          <td>Liste les modules livrables (100% verified)</td>
          <td><code>factory modules ADH</code></td>
        </tr>
        <tr>
          <td><code>plan</code></td>
          <td>Suggère les batches de migration</td>
          <td><code>factory plan ADH --max-batch 25</code></td>
        </tr>
        <tr>
          <td><code>serve</code></td>
          <td>Lance le serveur HTTP + SSE (dashboard live)</td>
          <td><code>factory serve</code></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- TAB: Packages -->
  <div class="doc-content" data-doc-content="packages">
    <h3>📦 Packages du monorepo</h3>
    <p>Le projet est organisé en monorepo pnpm avec 5 packages interdépendants.</p>

    <h4>1. parser (@magic-migration/parser)</h4>
    <p><strong>Path:</strong> <code>packages/parser/</code><br>
    <strong>Rôle:</strong> Parse les expressions Magic → AST → TypeScript/C#/Python<br>
    <strong>Fonctions:</strong> 300+ fonctions Magic implémentées</p>

    <h4>2. factory-cli (@magic-migration/factory)</h4>
    <p><strong>Path:</strong> <code>packages/factory-cli/</code><br>
    <strong>Rôle:</strong> Pipeline SPECMAP (CONTRACT → ENRICH → VERIFY)<br>
    <strong>Commandes:</strong> 15 commandes CLI<br>
    <strong>Tests:</strong> 458 tests Vitest</p>

    <h4>3. adh-web (@magic-migration/adh-web)</h4>
    <p><strong>Path:</strong> <code>packages/migrations/adh-web/</code><br>
    <strong>Rôle:</strong> Application web migrée (système Caisse ADH)<br>
    <strong>Stack:</strong> React 19, Vite 7, Tailwind v4, Zustand<br>
    <strong>Ports:</strong> 3071 (dev), 3072 (Storybook)</p>

    <h4>4. specmap-dashboard (@magic-migration/dashboard)</h4>
    <p><strong>Path:</strong> <code>packages/specmap-dashboard/</code><br>
    <strong>Rôle:</strong> Dashboard de progression SPECMAP multi-projets<br>
    <strong>Taille:</strong> Standalone HTML (pas de build)</p>

    <h4>5. spec-pipeline-v72</h4>
    <p><strong>Path:</strong> <code>tools/spec-pipeline-v72/</code><br>
    <strong>Rôle:</strong> Générateur automatique de specs depuis XML Magic<br>
    <strong>Phases:</strong> 5 phases (Discovery, Mapping, Decode, UI, Synthesis)</p>
  </div>

  <!-- TAB: Commandes -->
  <div class="doc-content" data-doc-content="commands">
    <h3>🚀 Cheat Sheet - Commandes utiles</h3>

    <h4>Génération de specs</h4>
    <pre><code># Générer une spec complète (5 phases)
powershell -NoProfile -File tools/spec-pipeline-v72/Run-SpecPipeline.ps1 \
  -Project ADH -IdePosition 237

# Enrichir avec Claude (section 2 + algorigramme)
/spec-pipeline ADH 237

# Batch - régénérer toutes les specs ADH
powershell -NoProfile -File tools/spec-pipeline-v72/Run-BatchADH.ps1</code></pre>

    <h4>Pipeline SPECMAP (factory-cli)</h4>
    <pre><code># Analyser + générer contract
pnpm --filter @magic-migration/factory contract ADH 237

# Enrichir (générer le code manquant)
pnpm --filter @magic-migration/factory enrich ADH 237 --mode heuristic

# Vérifier l'implémentation
pnpm --filter @magic-migration/factory verify ADH 237

# Pipeline complet (contract + enrich + verify)
pnpm --filter @magic-migration/factory run ADH 237

# Lancer le serveur HTTP pour dashboard live
pnpm --filter @magic-migration/factory serve</code></pre>

    <h4>Application adh-web</h4>
    <pre><code># Lancer le dev server (port 3071)
pnpm --filter @magic-migration/adh-web dev

# Tests
pnpm --filter @magic-migration/adh-web test
pnpm --filter @magic-migration/adh-web test:coverage

# Build production
pnpm --filter @magic-migration/adh-web build</code></pre>

    <h4>Dashboard</h4>
    <pre><code># Mettre à jour le dashboard avec les dernières données
powershell -NoProfile -File packages/specmap-dashboard/update-dashboard.ps1

# Lancer un serveur local (port 3070)
pnpm --filter @magic-migration/dashboard dev</code></pre>
  </div>

  <!-- TAB: Glossaire -->
  <div class="doc-content" data-doc-content="glossary">
    <h3>📖 Glossaire</h3>

    <table class="doc-table">
      <thead>
        <tr>
          <th>Terme</th>
          <th>Définition</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>ADH</strong></td>
          <td>Projet Adhérents/Caisse - 135 programmes Magic, système de point de vente Club Med</td>
        </tr>
        <tr>
          <td><strong>AST</strong></td>
          <td>Abstract Syntax Tree - Représentation arborescente du code après parsing</td>
        </tr>
        <tr>
          <td><strong>Batch</strong></td>
          <td>Groupe de programmes traités ensemble par le pipeline (max 25 programmes)</td>
        </tr>
        <tr>
          <td><strong>Callee</strong></td>
          <td>Programme appelé par le programme courant (downstream)</td>
        </tr>
        <tr>
          <td><strong>Caller</strong></td>
          <td>Programme qui appelle le programme courant (upstream)</td>
        </tr>
        <tr>
          <td><strong>Contract YAML</strong></td>
          <td>Fichier de spécification généré par la phase CONTRACT, décrit les gaps et la couverture</td>
        </tr>
        <tr>
          <td><strong>CONTRACTED</strong></td>
          <td>État SPECMAP : contract généré, prêt pour enrichissement</td>
        </tr>
        <tr>
          <td><strong>ENRICHED</strong></td>
          <td>État SPECMAP : code TypeScript généré, à vérifier</td>
        </tr>
        <tr>
          <td><strong>Factory CLI</strong></td>
          <td>Package @magic-migration/factory - CLI qui orchestre le pipeline SPECMAP</td>
        </tr>
        <tr>
          <td><strong>Gap</strong></td>
          <td>Élément manquant dans l'implémentation par rapport à la spec (MISSING ou PARTIAL)</td>
        </tr>
        <tr>
          <td><strong>Livrable</strong></td>
          <td>Module où 100% des programmes sont VERIFIED, prêt pour déploiement</td>
        </tr>
        <tr>
          <td><strong>Magic Unipaas</strong></td>
          <td>Plateforme RAD legacy v12.03 - langage propriétaire avec syntaxe d'expressions unique</td>
        </tr>
        <tr>
          <td><strong>MCP</strong></td>
          <td>Model Context Protocol - Outils Claude pour interroger la Knowledge Base Magic</td>
        </tr>
        <tr>
          <td><strong>Module</strong></td>
          <td>Programme + tous ses callees transitifs (arbre complet de dépendances)</td>
        </tr>
        <tr>
          <td><strong>N/A</strong></td>
          <td>État SPECMAP : non applicable (backend-only, pas de UI à migrer)</td>
        </tr>
        <tr>
          <td><strong>Orphelin</strong></td>
          <td>Programme jamais appelé (0 callers, pas de PublicName, pas dans ECF partagé)</td>
        </tr>
        <tr>
          <td><strong>PENDING</strong></td>
          <td>État SPECMAP : spec générée mais pas encore contractée</td>
        </tr>
        <tr>
          <td><strong>Spec</strong></td>
          <td>Spécification technique d'un programme Magic, générée par spec-pipeline-v72</td>
        </tr>
        <tr>
          <td><strong>SPECMAP</strong></td>
          <td>Specification Mapping - Méthodologie de migration en 3 phases (CONTRACT → ENRICH → VERIFY)</td>
        </tr>
        <tr>
          <td><strong>VERIFIED</strong></td>
          <td>État SPECMAP : implémentation validée par tests et vérifications, prêt pour prod</td>
        </tr>
        <tr>
          <td><strong>Wave</strong></td>
          <td>Vague de migration - Groupe de modules migrables en parallèle (même niveau de dépendance)</td>
        </tr>
      </tbody>
    </table>
  </div>

</section>


<footer>
  <p>Généré le 24 février 2026 à 02:35 par Migration Factory</p>
</footer>

</div>
<script>

// Module filter buttons
document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const filter = btn.dataset.filter;
    document.querySelectorAll('.module-row').forEach(row => {
      if (filter === 'all') { row.style.display = ''; return; }
      row.style.display = row.dataset.status === filter ? '' : 'none';
    });
  });
});

// Module sort buttons
document.querySelectorAll('.sort-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const sortBy = btn.dataset.sort;
    const list = document.querySelector('.module-list');
    if (!list) return;
    const rows = Array.from(list.querySelectorAll('.module-row'));
    rows.sort((a, b) => {
      if (sortBy === 'priority') return (Number(a.dataset.rank) || 999) - (Number(b.dataset.rank) || 999);
      if (sortBy === 'readiness') return (Number(b.dataset.readiness) || 0) - (Number(a.dataset.readiness) || 0);
      return (a.dataset.name || '').localeCompare(b.dataset.name || '');
    });
    rows.forEach(r => list.appendChild(r));
  });
});

// Program search
const searchInput = document.getElementById('prog-search');
const statusFilter = document.getElementById('status-filter');
const decomOnly = document.getElementById('decom-only');
const table = document.getElementById('program-table');

const filterTable = () => {
  if (!searchInput || !statusFilter || !decomOnly) return;
  const query = searchInput.value.toLowerCase();
  const status = statusFilter.value;
  const decom = decomOnly.checked;
  const rows = table.querySelectorAll('tbody tr');

  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    const id = cells[0].textContent.toLowerCase();
    const name = cells[1].textContent.toLowerCase();
    const rowStatus = cells[3].textContent.trim().toLowerCase();
    const hasDecom = cells[4].textContent.includes('OFF');

    const matchesSearch = !query || id.includes(query) || name.includes(query);
    const matchesStatus = !status || rowStatus === status;
    const matchesDecom = !decom || hasDecom;

    row.style.display = matchesSearch && matchesStatus && matchesDecom ? '' : 'none';
  });
};

if (searchInput) searchInput.addEventListener('input', filterTable);
if (statusFilter) statusFilter.addEventListener('change', filterTable);
if (decomOnly) decomOnly.addEventListener('change', filterTable);

// Table sort
let sortCol = null;
let sortDir = 1;
document.querySelectorAll('th[data-sort]').forEach(th => {
  th.addEventListener('click', () => {
    if (!table) return;
    const col = th.dataset.sort;
    if (sortCol === col) sortDir *= -1;
    else { sortCol = col; sortDir = 1; }

    const tbody = table.querySelector('tbody');
    const rows = Array.from(tbody.querySelectorAll('tr'));
    const colIndex = { id: 0, name: 1, level: 2, status: 3, grade: 4, score: 5, est: 6, domain: 8 }[col] ?? 0;

    rows.sort((a, b) => {
      const va = a.querySelectorAll('td')[colIndex].textContent.trim();
      const vb = b.querySelectorAll('td')[colIndex].textContent.trim();
      const na = Number(va), nb = Number(vb);
      if (!isNaN(na) && !isNaN(nb)) return (na - nb) * sortDir;
      return va.localeCompare(vb) * sortDir;
    });

    rows.forEach(r => tbody.appendChild(r));
  });
});


// Project tab switching
document.querySelectorAll('.project-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.project-tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    const project = tab.dataset.project;
    document.querySelectorAll('.tab-content').forEach(c => {
      c.classList.toggle('active', c.dataset.tab === project);
    });
    // Persist active tab in URL hash
    history.replaceState(null, '', '#' + project);
  });
});

// Restore active tab from URL hash on load
(function() {
  var hash = location.hash.replace('#', '');
  if (hash) {
    var tab = document.querySelector('.project-tab[data-project="' + hash + '"]');
    if (tab) tab.click();
  }
})();

// Click on project card -> switch to that tab
document.querySelectorAll('.project-card[data-goto]').forEach(card => {
  card.addEventListener('click', () => {
    const name = card.dataset.goto;
    const tab = document.querySelector('.project-tab[data-project="' + name + '"]');
    if (tab) tab.click();
  });
});

// ─── Action Bar ──────────────────────────────────────────────────
(function() {
  if (!window.__MF_SERVER__) return;

  var badge = document.getElementById('server-badge');
  var batchSelect = document.getElementById('batch-select');
  var btnPreflight = document.getElementById('btn-preflight');
  var btnRun = document.getElementById('btn-run');
  var btnVerify = document.getElementById('btn-verify');
  var btnGaps = document.getElementById('btn-gaps');
  var btnCalibrate = document.getElementById('btn-calibrate');
  var btnGenerate = document.getElementById('btn-generate');
  var btnMigrate = document.getElementById('btn-migrate');
  var btnMigrateAuto = document.getElementById('btn-migrate-auto');
  var btnAnalyze = document.getElementById('btn-analyze');
  var chkDry = document.getElementById('chk-dry');
  var panel = document.getElementById('action-panel');
  var panelTitle = document.getElementById('panel-title');
  var panelContent = document.getElementById('panel-content');
  var btnClose = document.getElementById('btn-close');

  // Activate UI
  badge.textContent = 'Connect\u00e9';
  badge.className = 'server-badge connected';
  batchSelect.disabled = false;
  btnPreflight.disabled = false;
  btnRun.disabled = false;
  btnVerify.disabled = false;
  btnGaps.disabled = false;
  btnCalibrate.disabled = false;
  btnGenerate.disabled = false;
  btnMigrate.disabled = false;
  btnMigrateAuto.disabled = false;
  btnAnalyze.disabled = false;
  var enrichSelect = document.getElementById('sel-enrich');
  enrichSelect.disabled = false;
  var savedEnrich = localStorage.getItem('mf-enrich-mode');
  if (savedEnrich) {
    for (var i = 0; i < enrichSelect.options.length; i++) {
      if (enrichSelect.options[i].value === savedEnrich) { enrichSelect.value = savedEnrich; break; }
    }
  }
  enrichSelect.addEventListener('change', function() { localStorage.setItem('mf-enrich-mode', enrichSelect.value); });
  chkDry.disabled = false;
  [btnPreflight, btnRun, btnVerify, btnGaps, btnCalibrate, btnGenerate, btnMigrate, btnMigrateAuto, btnAnalyze].forEach(function(b) { b.title = ''; });

  function showPanel(title, content) {
    panelTitle.textContent = title;
    panelContent.textContent = typeof content === 'string' ? content : JSON.stringify(content, null, 2);
    panel.classList.add('visible');
  }

  function setLoading(btn, loading) {
    if (loading) {
      btn.dataset.origText = btn.textContent;
      btn.innerHTML = '<span class="action-spinner"></span>' + btn.textContent;
      btn.disabled = true;
    } else {
      btn.textContent = btn.dataset.origText || btn.textContent;
      btn.disabled = false;
    }
  }

  btnClose.addEventListener('click', function() { panel.classList.remove('visible'); });

  // Load batches (hide fully verified ones from migration dropdown)
  fetch('/api/status').then(function(r) { return r.json(); }).then(function(batches) {
    if (!Array.isArray(batches)) return;
    batches.forEach(function(b) {
      if (b.status === 'verified') return; // Skip completed batches
      var opt = document.createElement('option');
      opt.value = b.id;
      opt.textContent = b.id + ' - ' + b.name + ' (' + b.programCount + ' progs, ' + b.verified + '/' + b.programCount + ' v\u00e9rifi\u00e9s)';
      batchSelect.appendChild(opt);
    });
  });

  // Preflight
  btnPreflight.addEventListener('click', function() {
    var batch = batchSelect.value;
    if (!batch) { showPanel('Erreur', 'S\u00e9lectionnez un batch d\'abord'); return; }
    setLoading(btnPreflight, true);
    fetch('/api/preflight?batch=' + encodeURIComponent(batch))
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var lines = ['Pr\u00e9-requis : ' + data.batchId + ' - ' + data.batchName, ''];
        data.checks.forEach(function(c) {
          lines.push((c.passed ? 'OK' : 'FAIL') + '  ' + c.check + ': ' + c.message);
        });
        if (data.programs.length > 0) {
          lines.push('', 'Programmes :');
          data.programs.forEach(function(p) {
            lines.push('  IDE ' + p.id + ' - ' + p.name + ' [' + p.action + ']' + (p.gaps > 0 ? ' (' + p.gaps + ' gaps)' : ''));
          });
        }
        lines.push('', 'R\u00e9sum\u00e9 : ' + data.summary.willContract + ' \u00e0 analyser, ' + data.summary.willVerify + ' \u00e0 v\u00e9rifier, ' + data.summary.needsEnrichment + ' \u00e0 enrichir, ' + data.summary.alreadyDone + ' termin\u00e9s, ' + data.summary.blocked + ' bloqu\u00e9s');
        showPanel('Pr\u00e9-requis : ' + batch, lines.join('\n'));
      })
      .finally(function() { setLoading(btnPreflight, false); });
  });

  // Run Pipeline (Streaming SSE)
  btnRun.addEventListener('click', function() {
    var batch = batchSelect.value;
    if (!batch) { showPanel('Erreur', 'S\u00e9lectionnez un batch d\'abord'); return; }
    setLoading(btnRun, true);
    var dryRun = chkDry.checked;
    var url = '/api/pipeline/stream?batch=' + encodeURIComponent(batch) + '&dryRun=' + dryRun;

    panelTitle.textContent = 'Pipeline: ' + batch + (dryRun ? ' (DRY-RUN)' : '');
    panelContent.innerHTML = '<div class="pipeline-progress">'
      + '<div class="progress-bar"><div class="progress-fill" id="pbar"></div></div>'
      + '<div class="p-status" id="pstatus">Connecting...</div>'
      + '<div class="p-log" id="plog"></div></div>';
    panel.classList.add('visible');

    var pbar = document.getElementById('pbar');
    var pstatus = document.getElementById('pstatus');
    var plog = document.getElementById('plog');
    var totalProgs = 0;
    var doneProgs = 0;

    function addLog(text) {
      var line = document.createElement('div');
      line.textContent = text;
      plog.appendChild(line);
      plog.scrollTop = plog.scrollHeight;
    }

    var es = new EventSource(url);

    es.onmessage = function(e) {
      var msg = JSON.parse(e.data);

      if (msg.type === 'preflight') {
        totalProgs = msg.data.programs.length;
        pstatus.textContent = 'Pr\u00e9-requis OK : ' + totalProgs + ' programmes ('
          + msg.data.summary.alreadyDone + ' termin\u00e9s, '
          + msg.data.summary.ready + ' pr\u00eats)';
        addLog('Pr\u00e9-requis : ' + msg.data.summary.ready + ' pr\u00eats, '
          + msg.data.summary.alreadyDone + ' d\u00e9j\u00e0 termin\u00e9s, '
          + msg.data.summary.blocked + ' bloqu\u00e9s');
        return;
      }

      if (msg.type === 'stream_end') {
        es.close();
        setLoading(btnRun, false);
        return;
      }

      if (msg.type === 'pipeline_result') {
        var r = msg.data;
        var elapsed = ((new Date(r.completed).getTime() - new Date(r.started).getTime()) / 1000).toFixed(1);
        pbar.style.width = '100%';
        pstatus.textContent = 'Termin\u00e9 en ' + elapsed + 's : '
          + r.summary.verified + ' v\u00e9rifi\u00e9s, '
          + r.summary.contracted + ' analys\u00e9s, '
          + r.summary.errors + ' erreurs';
        addLog('Pipeline termin\u00e9 en ' + elapsed + 's');
        return;
      }

      if (msg.type === 'error') {
        addLog('ERROR: ' + (msg.message || ''));
        pstatus.textContent = 'Erreur : ' + (msg.message || '');
        return;
      }

      doneProgs++;
      var pct = totalProgs > 0 ? Math.round((doneProgs / totalProgs) * 100) : 0;
      pbar.style.width = pct + '%';
      pstatus.textContent = doneProgs + '/' + totalProgs + ' (' + pct + '%) - ' + (msg.message || msg.type);
      addLog('[' + (msg.programId || '') + '] ' + (msg.message || msg.type));
    };

    es.onerror = function() {
      es.close();
      setLoading(btnRun, false);
      addLog('Connection lost');
      pstatus.textContent = 'Connection lost - check server';
    };
  });

  // Verify
  btnVerify.addEventListener('click', function() {
    setLoading(btnVerify, true);
    fetch('/api/verify', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ dryRun: chkDry.checked }),
    })
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var lines = ['V\u00e9rification ' + (data.dryRun ? '(SIMULATION)' : '') + ' r\u00e9sultat :', ''];
        lines.push(data.verified + ' v\u00e9rifi\u00e9s, ' + data.notReady + ' non pr\u00eats, ' + data.alreadyVerified + ' d\u00e9j\u00e0 v\u00e9rifi\u00e9s');
        if (data.details && data.details.length > 0) {
          lines.push('', 'Details:');
          data.details.forEach(function(d) {
            var line = '  IDE ' + d.id + ': ' + d.status;
            if (d.gaps && d.gaps.length > 0) line += ' (' + d.gaps.length + ' gaps)';
            lines.push(line);
          });
        }
        showPanel('V\u00e9rification', lines.join('\n'));
      })
      .finally(function() { setLoading(btnVerify, false); });
  });

  // Gaps
  btnGaps.addEventListener('click', function() {
    setLoading(btnGaps, true);
    fetch('/api/gaps')
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var lines = ['Rapport de Gaps', ''];
        if (data.contracts.length === 0) {
          lines.push('Aucun gap trouv\u00e9 - tous les contrats sont complets !');
        } else {
          data.contracts.forEach(function(cg) {
            var pct = cg.total > 0 ? Math.round((cg.impl / cg.total) * 100) : 0;
            lines.push('IDE ' + cg.id + ' - ' + cg.name + ' [' + cg.pipelineStatus + '] ' + cg.impl + '/' + cg.total + ' (' + pct + '%)');
            cg.gaps.slice(0, 5).forEach(function(g) {
              lines.push('  ' + g.type + ' ' + g.id + ': ' + g.status + (g.notes ? ' - ' + g.notes : ''));
            });
            if (cg.gaps.length > 5) lines.push('  ... et ' + (cg.gaps.length - 5) + ' de plus');
          });
        }
        lines.push('', 'Total : ' + data.grandTotalGaps + ' gaps (' + data.globalPct + '% complet)');
        showPanel('Rapport de Gaps', lines.join('\n'));
      })
      .finally(function() { setLoading(btnGaps, false); });
  });

  // Calibrate
  btnCalibrate.addEventListener('click', function() {
    setLoading(btnCalibrate, true);
    fetch('/api/calibrate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ dryRun: chkDry.checked }),
    })
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var lines = ['Calibration' + (chkDry.checked ? ' (SIMULATION)' : ''), ''];
        lines.push('Contrats v\u00e9rifi\u00e9s : ' + data.dataPoints);
        lines.push('Avant : ' + data.previousHpp + ' h/pt -> Calibr\u00e9 : ' + data.calibratedHpp + ' h/pt');
        lines.push('Estim\u00e9 : ' + data.totalEstimated + 'h | R\u00e9el : ' + data.totalActual + 'h');
        lines.push('Pr\u00e9cision : ' + data.accuracyPct + '%');
        if (data.details && data.details.length > 0) {
          lines.push('', 'D\u00e9tails :');
          data.details.forEach(function(d) {
            lines.push('  IDE ' + d.programId + ' : score=' + d.score + ' est=' + d.estimated + 'h r\u00e9el=' + d.actual + 'h');
          });
        }
        showPanel('Calibration', lines.join('\n'));
      })
      .finally(function() { setLoading(btnCalibrate, false); });
  });

  // Analyze Project
  btnAnalyze.addEventListener('click', function() {
    setLoading(btnAnalyze, true);
    fetch('/api/analyze', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ dryRun: chkDry.checked }),
    })
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var lines = ['Analyse du projet : ' + data.projectName, ''];
        lines.push('Programmes LIVE : ' + data.totalLivePrograms);
        lines.push('Batches conserv\u00e9s : ' + data.batchesPreserved + ' | Cr\u00e9\u00e9s : ' + data.batchesCreated + ' | Non assign\u00e9s : ' + data.unassignedCount);
        lines.push('');
        if (data.batches) {
          data.batches.forEach(function(b) {
            var flag = b.isNew ? 'NOUVEAU' : 'EXISTANT';
            lines.push(b.id + '  ' + b.name + '  [' + b.domain + ']  ' + b.memberCount + ' progs  Complexit\u00e9 ' + b.complexityGrade + '  ~' + b.estimatedHours + 'h  ' + flag);
          });
        }
        if (!chkDry.checked) {
          lines.push('', 'Batches sauvegard\u00e9s.');
        }
        showPanel('Analyse du projet', lines.join('\n'));
      })
      .catch(function(err) { showPanel('Erreur', String(err)); })
      .finally(function() { setLoading(btnAnalyze, false); });
  });

  // Generate Code (Streaming SSE)
  btnGenerate.addEventListener('click', function() {
    var batch = batchSelect.value;
    if (!batch) { showPanel('Erreur', 'S\u00e9lectionnez un batch d\'abord'); return; }
    var outputDir = prompt('R\u00e9pertoire de sortie pour les fichiers g\u00e9n\u00e9r\u00e9s :', './adh-web/src');
    if (!outputDir) return;
    setLoading(btnGenerate, true);
    var dryRun = chkDry.checked;
    var enrichMode = document.getElementById('sel-enrich').value || 'none';
    var url = '/api/generate/stream?batch=' + encodeURIComponent(batch) + '&outputDir=' + encodeURIComponent(outputDir) + '&dryRun=' + dryRun + '&enrich=' + enrichMode;

    var enrichLabel = enrichMode !== 'none' ? ' [enrichissement: ' + enrichMode + ']' : '';
    var lines = ['G\u00e9n\u00e9ration de code' + (dryRun ? ' (SIMULATION)' : '') + enrichLabel + ' - Batch ' + batch, 'Sortie : ' + outputDir, ''];
    showPanel('G\u00e9n\u00e9ration de code', lines.join('\n'));

    var es = new EventSource(url);
    es.onmessage = function(ev) {
      var msg = JSON.parse(ev.data);

      if (msg.type === 'stream_end') {
        es.close();
        setLoading(btnGenerate, false);
        return;
      }

      if (msg.type === 'codegen_started') {
        lines.push('D\u00e9marrage : ' + msg.total + ' programmes');
      } else if (msg.type === 'codegen_program') {
        lines.push('[' + msg.progress + '] IDE ' + msg.programId + ' ' + msg.programName + ': ' + msg.written + ' written, ' + msg.skipped + ' skipped');
      } else if (msg.type === 'codegen_skip') {
        lines.push('SKIP IDE ' + msg.programId + ': ' + msg.message);
      } else if (msg.type === 'codegen_completed') {
        lines.push('', 'Termin\u00e9 : ' + msg.processed + ' programmes, ' + msg.totalWritten + ' fichiers ' + (msg.dryRun ? '\u00e0 \u00e9crire' : '\u00e9crits') + ', ' + msg.totalSkipped + ' ignor\u00e9s');
      } else if (msg.type === 'error') {
        lines.push('ERROR: ' + msg.message);
      }

      panelContent.textContent = lines.join('\n');
    };

    es.onerror = function() {
      es.close();
      setLoading(btnGenerate, false);
      lines.push('Connexion perdue');
      panelContent.textContent = lines.join('\n');
    };
  });

  // ─── Shared helpers ────────────────────────────────────────────
  var migrateOverlay = document.getElementById('migrate-overlay');
  var migrateOverlayTitle = document.getElementById('migrate-overlay-title');
  var migrateOverlayClose = document.getElementById('migrate-overlay-close');

  function formatElapsed(ms) {
    var totalSec = Math.floor(ms / 1000);
    var h = Math.floor(totalSec / 3600);
    var m = Math.floor((totalSec % 3600) / 60);
    var s = totalSec % 60;
    if (h > 0) return h + 'h ' + m + 'm ' + s + 's';
    if (m > 0) return m + 'm ' + s + 's';
    return s + 's';
  }

  var migrateMinimize = document.getElementById('migrate-overlay-minimize');
  var migratePanelToggle = document.getElementById('migrate-panel-toggle');
  var migrateBadge = document.getElementById('migrate-panel-badge');

  // ─── Migration state ──────────────────────────────────────────
  var ALL_PHASES = ['spec','contract','analyze','types','store','api','page','components',
    'tests-unit','tests-ui','verify-tsc','fix-tsc','verify-tests','fix-tests','integrate','review'];

  var migrateState = {
    totalProgs: 0, doneProgs: 0, failedProgs: 0,
    programList: [],
    programPhases: {},
    migrationStart: 0, elapsedTid: 0, logCollapsed: false,
    activeBtn: null, parallelCount: 0,
    programStartTimes: {}, programDurations: [],
    tokensIn: 0, tokensOut: 0,
    eventsProcessed: 0,
    estimatedHours: 0,
    batchPhaseActive: false, batchPhaseStart: 0,
    batchProgress: 0, batchElapsedStart: 0, batchReviewsDone: 0
  };

  function escAttr(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

  function showMigrateOverlay(title) {
    migrateOverlayTitle.textContent = title;
    document.getElementById('mp-module-bar').style.width = '0%';
    document.getElementById('mp-module-label').textContent = '0/0 (0%)';
    document.getElementById('mp-elapsed').textContent = '';
    var tokEl = document.getElementById('mp-tokens'); if (tokEl) tokEl.textContent = 'Tokens: --';
    document.getElementById('mp-prog-section').style.display = 'none';
    document.getElementById('mp-grid-section').style.display = 'none';
    document.getElementById('mp-grid-body').innerHTML = '';
    document.getElementById('mp-log').innerHTML = '';
    migrateOverlay.classList.remove('collapsed');
    migrateOverlay.classList.add('visible');
    migrateMinimize.textContent = '_';
    if (migrateBadge) migrateBadge.style.display = 'none';
    // Reset batch progress tracking
    migrateState.batchProgress = 0;
    migrateState.batchElapsedStart = 0;
    migrateState.batchReviewsDone = 0;
  }

  function closeMigrateOverlay() {
    migrateOverlay.classList.remove('visible');
    migrateOverlay.classList.remove('collapsed');
  }

  function toggleMigratePanel() {
    migrateOverlay.classList.toggle('collapsed');
    migrateMinimize.textContent = migrateOverlay.classList.contains('collapsed') ? '+' : '_';
  }

  var migrateAbortBtn = document.getElementById('migrate-overlay-abort');
  var mpDryBadge = document.getElementById('mp-dry-badge');

  migrateOverlayClose.addEventListener('click', closeMigrateOverlay);
  migrateMinimize.addEventListener('click', function(e) { e.stopPropagation(); toggleMigratePanel(); });
  migratePanelToggle.addEventListener('dblclick', toggleMigratePanel);

  migrateAbortBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    if (!confirm('Annuler la migration en cours ?')) return;
    fetch('/api/migrate/abort', { method: 'POST' }).then(function(r) { return r.json(); }).then(function(data) {
      if (data.aborted) {
        addMLog('Migration aborted by user');
        migrateAbortBtn.style.display = 'none';
      }
    });
  });

  // Log toggle
  var mpLogToggle = document.getElementById('mp-log-toggle');
  mpLogToggle.addEventListener('click', function() {
    var section = document.querySelector('.mp-log-section');
    section.classList.toggle('collapsed');
    migrateState.logCollapsed = section.classList.contains('collapsed');
  });

  function computeETA() {
    var remaining = migrateState.totalProgs - migrateState.doneProgs - migrateState.failedProgs;

    // ── Batch phase ETA (all programs done, verification/review running) ──
    if (remaining <= 0 && migrateState.batchPhaseActive) {
      var bp = migrateState.batchProgress;
      if (bp > 0 && migrateState.batchElapsedStart > 0) {
        var batchElapsed = Date.now() - migrateState.batchElapsedStart;
        var batchRemaining = batchElapsed * ((1 - bp) / bp);
        return ' | V\u00e9rification... ETA: ~' + formatElapsed(batchRemaining);
      }
      return ' | V\u00e9rification en cours...';
    }
    if (remaining <= 0) return '';

    // ── Per-program ETA ──
    var par = migrateState.parallelCount > 1 ? migrateState.parallelCount : 1;
    var durations = migrateState.programDurations;
    // Filter trivial (<5s) = programs with existing files (no real generation)
    var real = [];
    for (var i = 0; i < durations.length; i++) { if (durations[i] >= 5000) real.push(durations[i]); }

    // If we have real durations (actual generation), use average
    if (real.length >= 2) {
      var sum = 0;
      for (var i = 0; i < real.length; i++) sum += real[i];
      var avgMs = sum / real.length;
      return ' | ETA: ~' + formatElapsed(Math.ceil(remaining / par) * avgMs);
    }
    if (real.length === 1) {
      return ' | ETA: ~' + formatElapsed(Math.ceil(remaining / par) * real[0]);
    }

    // All programs trivial (<5s) = existing files, no meaningful ETA for per-program phase
    var completed = migrateState.doneProgs + migrateState.failedProgs;
    if (completed > 0 && real.length === 0) {
      return ' | fichiers existants';
    }

    // 0 completed: use pre-calculated estimate if available
    if (migrateState.estimatedHours > 0) {
      var estMs = migrateState.estimatedHours * 3600000 / par;
      return ' | ETA: ~' + formatElapsed(estMs);
    }
    return ' | Estimation en cours...';
  }

  function formatTokens(n) { return n >= 1000000 ? (n / 1000000).toFixed(1) + 'M' : Math.round(n / 1000) + 'K'; }

  function estimateCost(tokIn, tokOut) {
    // Default to sonnet pricing: $3/MTok in, $15/MTok out
    return (tokIn / 1000000) * 3 + (tokOut / 1000000) * 15;
  }

  function updateTokenDisplay() {
    var el = document.getElementById('mp-tokens');
    if (!el) return;
    if (migrateState.tokensIn === 0 && migrateState.tokensOut === 0) {
      el.textContent = 'Tokens: --';
      return;
    }
    var cost = estimateCost(migrateState.tokensIn, migrateState.tokensOut);
    el.textContent = 'Tokens: ' + formatTokens(migrateState.tokensIn) + ' in / ' + formatTokens(migrateState.tokensOut) + ' out (~$' + cost.toFixed(2) + ')';
  }

  function updateRunningDurations() {
    var now = Date.now();
    for (var pid in migrateState.programStartTimes) {
      var el = document.getElementById('mp-dur-' + pid);
      if (el) el.textContent = formatElapsed(now - migrateState.programStartTimes[pid]);
    }
  }

  function startElapsedTimer(startedAt) {
    var elDiv = document.getElementById('mp-elapsed');
    if (!elDiv) return 0;
    var tid = setInterval(function() {
      var el = document.getElementById('mp-elapsed');
      if (!el) { clearInterval(tid); return; }
      el.textContent = 'Elapsed: ' + formatElapsed(Date.now() - startedAt) + computeETA();
      updateRunningDurations();
      // Refresh progress label during batch phases so ETA updates
      if (migrateState.batchPhaseActive) {
        updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      }
    }, 1000);
    elDiv.textContent = 'Elapsed: ' + formatElapsed(Date.now() - startedAt);
    return tid;
  }

  function addMLog(text) {
    var mlog = document.getElementById('mp-log');
    if (!mlog) return;
    var line = document.createElement('div');
    line.textContent = text;
    mlog.appendChild(line);
    mlog.scrollTop = mlog.scrollHeight;
  }

  // ─── Grid construction ────────────────────────────────────────
  function buildProgramGrid(list) {
    var tbody = document.getElementById('mp-grid-body');
    tbody.innerHTML = '';
    migrateState.programPhases = {};
    for (var i = 0; i < list.length; i++) {
      var p = list[i];
      migrateState.programPhases[p.id] = { status: 'pending', currentPhase: null, completedPhases: {} };
      var tr = document.createElement('tr');
      tr.id = 'mp-row-' + p.id;
      var dotsHtml = '';
      for (var j = 0; j < ALL_PHASES.length; j++) {
        dotsHtml += '<span class="mp-dot" data-prog="' + escAttr(p.id) + '" data-phase="' + ALL_PHASES[j] + '" title="' + ALL_PHASES[j] + '"></span>';
      }
      tr.innerHTML = '<td>' + escAttr(p.id) + '</td>'
        + '<td title="' + escAttr(p.name) + '">' + escAttr(p.name) + '</td>'
        + '<td class="mp-icon" id="mp-icon-' + escAttr(p.id) + '">&#9203;</td>'
        + '<td class="mp-dur" id="mp-dur-' + escAttr(p.id) + '"></td>'
        + '<td><div class="mp-dots">' + dotsHtml + '</div></td>';
      tbody.appendChild(tr);
    }
    document.getElementById('mp-grid-section').style.display = '';
  }

  function updateProgramIcon(id, status) {
    var el = document.getElementById('mp-icon-' + id);
    if (!el) return;
    var row = document.getElementById('mp-row-' + id);
    if (status === 'running') { el.innerHTML = '&#9654;'; if (row) { row.classList.add('mp-row-active'); row.classList.remove('mp-row-done'); } }
    else if (status === 'done') { el.innerHTML = '&#10003;'; if (row) { row.classList.remove('mp-row-active'); row.classList.add('mp-row-done'); } }
    else if (status === 'failed') { el.innerHTML = '&#10007;'; if (row) { row.classList.remove('mp-row-active'); row.classList.add('mp-row-done'); } }
    else { el.innerHTML = '&#9203;'; }
  }

  function updatePhaseDot(progId, phase, state) {
    var dots = document.querySelectorAll('.mp-dot[data-prog="' + progId + '"][data-phase="' + phase + '"]');
    for (var i = 0; i < dots.length; i++) {
      dots[i].className = 'mp-dot' + (state === 'done' ? ' done' : state === 'active' ? ' active' : state === 'failed' ? ' failed' : state === 'skipped' ? ' skipped' : '');
    }
  }

  function updateModuleProgress(done, total) {
    var bar = document.getElementById('mp-module-bar');
    var label = document.getElementById('mp-module-label');
    if (!bar || !label) return;
    var processed = done + migrateState.failedProgs;
    // Progress bar: 0-70% per-program generation, 70-100% batch phases
    var progPct = total > 0 ? (processed / total) * 70 : 0;
    var batchPct = migrateState.batchProgress * 30;
    var pct = Math.min(100, Math.round(progPct + batchPct));
    bar.style.width = pct + '%';
    var eta = computeETA();
    if (migrateState.failedProgs > 0) {
      bar.style.background = 'linear-gradient(90deg, var(--green) 0%, #f59e0b 100%)';
      label.textContent = done + '/' + total + ' OK, ' + migrateState.failedProgs + ' \u00e9chou\u00e9(s) (' + pct + '%)' + eta;
    } else {
      label.textContent = done + '/' + total + ' programmes (' + pct + '%)' + eta;
    }
    if (migrateBadge) { migrateBadge.textContent = done + '/' + total; migrateBadge.style.display = ''; }
  }

  function updateProgramProgress(progId, phase) {
    var section = document.getElementById('mp-prog-section');
    var titleEl = document.getElementById('mp-prog-title');
    var bar = document.getElementById('mp-prog-bar');
    var label = document.getElementById('mp-prog-label');
    if (!section || !titleEl || !bar || !label) return;

    if (!progId) { section.style.display = 'none'; return; }
    section.style.display = '';

    var ps = migrateState.programPhases[progId];
    var progName = '';
    for (var i = 0; i < migrateState.programList.length; i++) {
      if (String(migrateState.programList[i].id) === String(progId)) { progName = migrateState.programList[i].name; break; }
    }

    var phaseIdx = phase ? ALL_PHASES.indexOf(phase) : -1;
    var doneCount = ps ? Object.keys(ps.completedPhases).length : 0;
    var total = ALL_PHASES.length;

    titleEl.textContent = 'IDE ' + progId + ' ' + progName + (phase ? ' (' + (phaseIdx + 1) + '/' + total + ' - ' + phase + ')' : '');
    var pct = total > 0 ? Math.round((doneCount / total) * 100) : 0;
    bar.style.width = pct + '%';
    label.textContent = doneCount + '/' + total;
  }

  // ─── Central event dispatch ───────────────────────────────────
  function processMigrateEvent(msg) {
    if (msg.type === 'migrate_started') {
      migrateState.totalProgs = msg.programs || 0;
      migrateState.doneProgs = 0;
      migrateState.estimatedHours = msg.estimatedHours || 0;
      if (msg.parallel > 0) migrateState.parallelCount = msg.parallel;
      if (msg.programList && msg.programList.length) {
        migrateState.programList = msg.programList;
        buildProgramGrid(msg.programList);
      }
      updateModuleProgress(0, migrateState.totalProgs);
      var agentInfo = msg.parallel > 0 ? ', ' + msg.parallel + ' agents' : '';
      addMLog('Migration d\u00e9marr\u00e9e : ' + migrateState.totalProgs + ' programmes' + agentInfo + (migrateState.estimatedHours > 0 ? ' (~' + migrateState.estimatedHours.toFixed(1) + 'h estim\u00e9es)' : ''));
      // Update overlay title with agent count
      if (msg.parallel > 0) {
        var title = migrateOverlayTitle.textContent || '';
        title = title.replace(/\(auto-parallel\)/, 'x' + msg.parallel + ' agents');
        migrateOverlayTitle.textContent = title;
      }
      return;
    }

    if (msg.type === 'parallel_resolved') {
      var resolved = msg.data && msg.data.resolved ? msg.data.resolved : 0;
      migrateState.parallelCount = resolved;
      var title = migrateOverlayTitle.textContent || '';
      var newTitle = title.replace('(auto-parallel)', 'x' + resolved + ' agents');
      if (newTitle === title && resolved > 0) {
        // Title doesn't contain (auto-parallel) (CLI-started migration), append
        newTitle = title + ' x' + resolved + ' agents';
      }
      migrateOverlayTitle.textContent = newTitle;
      addMLog('Auto-parallel: ' + resolved + ' agents (' + (msg.data && msg.data.cpus || '?') + ' CPUs)');
      return;
    }

    if (msg.type === 'program_started') {
      var pid = msg.programId;
      migrateState.programStartTimes[pid] = Date.now();
      if (migrateState.programPhases[pid]) {
        migrateState.programPhases[pid].status = 'running';
        migrateState.programPhases[pid].currentPhase = null;
      }
      updateProgramIcon(pid, 'running');
      updateProgramProgress(pid, null);
      addMLog('[start] IDE ' + pid);
      return;
    }

    if (msg.type === 'phase_started') {
      var pid = msg.programId;
      var phase = msg.phase;
      var isBatchPhase = phase && migrateState.totalProgs > 0 && (migrateState.doneProgs + migrateState.failedProgs >= migrateState.totalProgs);

      // Detect batch phase regardless of pid presence
      if (isBatchPhase) {
        migrateState.batchPhaseActive = true;
        if (!migrateState.batchPhaseStart) migrateState.batchPhaseStart = Date.now();
        if (!migrateState.batchElapsedStart) migrateState.batchElapsedStart = Date.now();
        // Re-activate program timer for per-program batch phases (review)
        if (pid) migrateState.programStartTimes[pid] = Date.now();
        // Refresh progress label to show batch info + ETA
        updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      }

      if (pid && migrateState.programPhases[pid]) {
        var prev = migrateState.programPhases[pid].currentPhase;
        if (prev && prev !== phase) {
          migrateState.programPhases[pid].completedPhases[prev] = true;
          updatePhaseDot(pid, prev, 'done');
        }
        migrateState.programPhases[pid].currentPhase = phase;
        if (phase) updatePhaseDot(pid, phase, 'active');
        updateProgramProgress(pid, phase);
      } else if (phase && !pid) {
        // Batch-level phase without pid (verify-tsc, integrate) - show in prog section
        var section = document.getElementById('mp-prog-section');
        var titleEl = document.getElementById('mp-prog-title');
        var bar = document.getElementById('mp-prog-bar');
        var label = document.getElementById('mp-prog-label');
        if (section && titleEl) {
          section.style.display = '';
          titleEl.textContent = phase.toUpperCase() + ': ' + (msg.message || 'en cours...');
          titleEl.style.color = '#f59e0b';
          if (bar) { bar.style.width = ''; bar.style.background = '#f59e0b'; bar.className = 'mp-bar-fill mp-bar-prog mp-pulse-bar'; }
          if (label) label.textContent = '';
        }
        // Update batch progress from verify loop events (verifyProgress: 0..1 → batchProgress: 0..0.4)
        if (msg.data && typeof msg.data.verifyProgress === 'number') {
          migrateState.batchProgress = msg.data.verifyProgress * 0.4;
          updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
        }
      }
      addMLog('[' + (phase || '') + '] ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'phase_completed') {
      var pid = msg.programId;
      var phase = msg.phase;
      if (pid && migrateState.programPhases[pid] && phase) {
        migrateState.programPhases[pid].completedPhases[phase] = true;
        if (migrateState.programPhases[pid].currentPhase === phase) {
          migrateState.programPhases[pid].currentPhase = null;
        }
        updatePhaseDot(pid, phase, 'done');
        updateProgramProgress(pid, null);
        // Update duration for batch-level per-program phases (review)
        if (migrateState.batchPhaseActive && migrateState.programStartTimes[pid]) {
          var batchDur = Date.now() - migrateState.programStartTimes[pid];
          delete migrateState.programStartTimes[pid];
          var batchDurEl = document.getElementById('mp-dur-' + pid);
          if (batchDurEl) { batchDurEl.textContent = formatElapsed(batchDur); batchDurEl.style.color = '#d2a8ff'; }
        }
      }
      // Track batch progress for review per-program completions
      if (migrateState.batchPhaseActive && pid && phase === 'review') {
        migrateState.batchReviewsDone++;
        var reviewPct = migrateState.totalProgs > 0 ? migrateState.batchReviewsDone / migrateState.totalProgs : 1;
        migrateState.batchProgress = 0.7 + 0.3 * reviewPct;
        updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      }
      if (phase && !pid) {
        // Batch-level phase completed - update prog section + batch progress
        if (migrateState.batchPhaseActive && phase === 'integrate') {
          migrateState.batchProgress = 0.7;
          updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
        }
        var titleEl = document.getElementById('mp-prog-title');
        var bar = document.getElementById('mp-prog-bar');
        if (titleEl) { titleEl.textContent = phase.toUpperCase() + ': ' + (msg.message || 'done'); titleEl.style.color = '#3fb950'; }
        if (bar) { bar.className = 'mp-bar-fill mp-bar-prog'; bar.style.width = '100%'; bar.style.background = '#3fb950'; }
      }
      addMLog('[' + (phase || '') + '] ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'phase_failed') {
      var pid = msg.programId;
      var phase = msg.phase;
      if (phase) updatePhaseDot(pid, phase, 'failed');
      addMLog('[' + (phase || '') + '] FAIL: ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'program_completed') {
      var pid = msg.programId;
      var isSkipped = msg.data && msg.data.skipped;
      // Prefer server-side duration (accurate), fallback to client-side
      var dur = (msg.data && typeof msg.data.duration === 'number') ? msg.data.duration : (migrateState.programStartTimes[pid] ? Date.now() - migrateState.programStartTimes[pid] : 0);
      if (!isSkipped && dur > 0) migrateState.programDurations.push(dur);
      delete migrateState.programStartTimes[pid];
      var durEl = document.getElementById('mp-dur-' + pid);
      if (durEl) {
        var isResumed = msg.data && msg.data.resumed;
        var isExisting = !isSkipped && !isResumed && dur < 3000;
        durEl.textContent = isSkipped ? 'v\u00e9rifi\u00e9' : (isResumed ? 'reprise' : (isExisting ? 'existant' : formatElapsed(dur)));
        durEl.style.color = isSkipped ? '#6b7280' : (isResumed ? '#58a6ff' : (isExisting ? '#8b5cf6' : '#3fb950'));
      }
      if (migrateState.programPhases[pid]) {
        if (isSkipped) {
          // Mark all generation phase dots as skipped (grey)
          for (var si = 0; si < ALL_PHASES.length; si++) updatePhaseDot(pid, ALL_PHASES[si], 'skipped');
        } else {
          var cur = migrateState.programPhases[pid].currentPhase;
          if (cur) { migrateState.programPhases[pid].completedPhases[cur] = true; updatePhaseDot(pid, cur, 'done'); }
        }
        migrateState.programPhases[pid].status = 'done';
        migrateState.programPhases[pid].currentPhase = null;
      }
      // Accumulate tokens
      if (msg.data && msg.data.tokens) {
        migrateState.tokensIn += msg.data.tokens.input || 0;
        migrateState.tokensOut += msg.data.tokens.output || 0;
        updateTokenDisplay();
      }
      updateProgramIcon(pid, 'done');
      migrateState.doneProgs++;
      updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      updateProgramProgress(null, null);
      addMLog(isSkipped ? '[ignor\u00e9] IDE ' + pid + ' : d\u00e9j\u00e0 migr\u00e9' : '[termin\u00e9] IDE ' + pid + ' : ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'program_failed') {
      var pid = msg.programId;
      if (migrateState.programStartTimes[pid]) {
        var failDur = Date.now() - migrateState.programStartTimes[pid];
        migrateState.programDurations.push(failDur);
        delete migrateState.programStartTimes[pid];
        var failDurEl = document.getElementById('mp-dur-' + pid);
        if (failDurEl) { failDurEl.textContent = formatElapsed(failDur); failDurEl.style.color = '#f85149'; }
      }
      if (migrateState.programPhases[pid]) {
        var cur = migrateState.programPhases[pid].currentPhase;
        if (cur) updatePhaseDot(pid, cur, 'failed');
        migrateState.programPhases[pid].status = 'failed';
      }
      updateProgramIcon(pid, 'failed');
      migrateState.failedProgs++;
      updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      updateProgramProgress(null, null);
      addMLog('[FAIL] IDE ' + pid + ': ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'migrate_result') {
      var r = msg.data;
      migrateState.batchPhaseActive = false;
      clearInterval(migrateState.elapsedTid);
      var bar = document.getElementById('mp-module-bar');
      if (bar) bar.style.width = '100%';
      var label = document.getElementById('mp-module-label');
      var failed = r && r.summary ? r.summary.failed : migrateState.failedProgs;
      if (label && r && r.summary) {
        var costStr = '';
        if (r.summary.totalTokens) {
          migrateState.tokensIn = r.summary.totalTokens.input;
          migrateState.tokensOut = r.summary.totalTokens.output;
          costStr = ', ~$' + (r.summary.estimatedCostUsd || 0).toFixed(2);
          updateTokenDisplay();
        }
        var allSkipped = r.summary.skipped === r.summary.total;
        var isDryRun = r.dryRun;
        var prefix = isDryRun ? '[DRY-RUN] ' : '';
        if (allSkipped) {
          label.textContent = prefix + 'Termin\u00e9 : ' + r.summary.total + '/' + r.summary.total + ' d\u00e9j\u00e0 migr\u00e9s (rien \u00e0 faire)' + costStr;
        } else {
          var tscLabel = isDryRun ? '' : (r.summary.tscClean ? ', TSC OK' : ', TSC erreurs');
          var testsLabel = isDryRun ? '' : (r.summary.testsPass ? ', tests OK' : ', tests \u00e9chou\u00e9s');
          var coverageLabel = isDryRun ? '' : ', couverture ' + r.summary.reviewAvgCoverage + '%';
          label.textContent = prefix + 'Termin\u00e9 : ' + r.summary.completed + '/' + r.summary.total
            + ' compl\u00e9t\u00e9s' + (failed > 0 ? ', ' + failed + ' \u00e9chou\u00e9(s)' : '')
            + (r.summary.skipped > 0 ? ', ' + r.summary.skipped + ' v\u00e9rifi\u00e9s' : '')
            + ', ' + r.summary.totalFiles + ' fichiers'
            + tscLabel + testsLabel + coverageLabel
            + costStr;
        }
      }
      var elapsed = document.getElementById('mp-elapsed');
      if (elapsed) elapsed.textContent = 'Total: ' + formatElapsed(Date.now() - migrateState.migrationStart);
      if (failed > 0) {
        if (bar) bar.style.background = 'linear-gradient(90deg, var(--green) 0%, #f85149 100%)';
        if (migrateBadge) { migrateBadge.textContent = r.summary.completed + '/' + r.summary.total; migrateBadge.style.background = '#f59e0b'; }
      } else {
        if (migrateBadge) { migrateBadge.textContent = 'Done'; migrateBadge.style.background = 'var(--green)'; }
      }
      document.getElementById('mp-prog-section').style.display = 'none';
      addMLog('Migration termin\u00e9e' + (failed > 0 ? ' (' + failed + ' \u00e9chou\u00e9(s))' : ''));
      if (r && r.git) addMLog('[git] Committed ' + r.git.commitSha + ' pushed to ' + r.git.branch);
      addMLog('Migration termin\u00e9e.');
      return;
    }

    if (msg.type === 'verify_pass') {
      // Verification loop done (TSC + tests) = 40% of batch work
      migrateState.batchProgress = 0.4;
      updateModuleProgress(migrateState.doneProgs, migrateState.totalProgs);
      addMLog('[verify] ' + (msg.message || ''));
      return;
    }

    if (msg.type === 'stream_end') return;

    if (msg.type === 'error') {
      addMLog('ERROR: ' + (msg.message || ''));
      return;
    }

    // Default: log anything else
    addMLog('[' + (msg.phase || msg.type || '') + '] ' + (msg.message || msg.type || ''));
  }

  // ─── Confirmation modal ──────────────────────────────────────
  var confirmModal = document.getElementById('migrate-confirm-modal');
  var modalCancel = document.getElementById('modal-cancel');
  var modalLaunch = document.getElementById('modal-launch');

  modalCancel.addEventListener('click', function() { confirmModal.classList.remove('visible'); });
  confirmModal.addEventListener('click', function(e) { if (e.target === confirmModal) confirmModal.classList.remove('visible'); });

  function launchMigration(batch, targetDir, parallelCount, claudeMode, dryRun, sourceBtn, isAuto) {
    confirmModal.classList.remove('visible');
    setLoading(sourceBtn || btnMigrate, true);
    migrateState.activeBtn = sourceBtn || btnMigrate;
    migrateState.parallelCount = parseInt(parallelCount) || 0;
    migrateState.tokensIn = 0;
    migrateState.tokensOut = 0;

    var url = '/api/migrate/stream?batch=' + encodeURIComponent(batch)
      + '&targetDir=' + encodeURIComponent(targetDir)
      + '&dryRun=' + dryRun
      + '&parallel=' + parallelCount
      + '&mode=' + claudeMode;

    var headerPrefix = isAuto ? 'Migration Auto' : 'Migration';
    var parallelInfo = migrateState.parallelCount > 0 ? ' x' + migrateState.parallelCount + ' agents' : ' (auto-parallel)';
    showMigrateOverlay(headerPrefix + ': ' + batch + ' [' + claudeMode.toUpperCase() + ']' + parallelInfo);
    migrateAbortBtn.style.display = 'inline-block';
    mpDryBadge.style.display = dryRun ? 'inline-block' : 'none';
    migrateState.migrationStart = Date.now();
    migrateState.elapsedTid = startElapsedTimer(migrateState.migrationStart);
    migrateState.totalProgs = 0;
    migrateState.doneProgs = 0;
    migrateState.failedProgs = 0;
    migrateState.programList = [];
    migrateState.programPhases = {};
    migrateState.programStartTimes = {};
    migrateState.programDurations = [];
    migrateState.batchPhaseActive = false;
    migrateState.batchPhaseStart = 0;

    migrateState.eventsProcessed = 0;
    var es = new EventSource(url);
    es.onmessage = function(ev) {
      var msg = JSON.parse(ev.data);

      if (msg.type === 'stream_end') {
        es.close();
        clearInterval(migrateState.elapsedTid);
        setLoading(migrateState.activeBtn || btnMigrate, false);
        migrateAbortBtn.style.display = 'none';
        return;
      }

      migrateState.eventsProcessed++;
      processMigrateEvent(msg);
    };

    es.onerror = function() {
      es.close();
      addMLog('SSE connection lost - switching to polling...');
      // Fall back to polling instead of giving up
      var lastSeen = migrateState.eventsProcessed;
      var pollFallback = setInterval(function() {
        fetch('/api/migrate/active').then(function(r) { return r.json(); }).then(function(s) {
          if (!s.running && s.events.length === 0) {
            clearInterval(pollFallback);
            clearInterval(migrateState.elapsedTid);
            setLoading(migrateState.activeBtn || btnMigrate, false);
            migrateAbortBtn.style.display = 'none';
            addMLog('Migration not found - connection lost');
            return;
          }
          // Process only new events
          for (var i = lastSeen; i < s.events.length; i++) {
            processMigrateEvent(s.events[i]);
          }
          lastSeen = s.events.length;
          if (!s.running) {
            clearInterval(pollFallback);
            clearInterval(migrateState.elapsedTid);
            setLoading(migrateState.activeBtn || btnMigrate, false);
            migrateAbortBtn.style.display = 'none';
            var elapsed = document.getElementById('mp-elapsed');
            if (elapsed) elapsed.textContent = 'Total: ' + formatElapsed(Date.now() - migrateState.migrationStart);
            if (migrateBadge) { migrateBadge.textContent = 'Done'; migrateBadge.style.background = 'var(--green)'; }
          }
        }).catch(function() {
          clearInterval(pollFallback);
          clearInterval(migrateState.elapsedTid);
          setLoading(migrateState.activeBtn || btnMigrate, false);
          migrateAbortBtn.style.display = 'none';
          addMLog('Connection lost');
        });
      }, 3000);
    };
  }

  // ─── Migrate Module (opens confirmation modal) ────────────────
  btnMigrate.addEventListener('click', function() {
    var batch = batchSelect.value;
    if (!batch) { showPanel('Erreur', 'S\u00e9lectionnez un batch d\'abord'); return; }

    var enrichSel = document.getElementById('sel-enrich').value || 'none';
    var claudeMode = enrichSel === 'claude' ? 'api' : 'cli';
    var dryRun = chkDry.checked;

    // Populate modal
    document.getElementById('modal-batch-info').textContent = batch;
    document.getElementById('modal-target-dir').value = 'adh-web';
    document.getElementById('modal-target-resolved').textContent = '(resolved server-side relative to project root)';
    document.getElementById('modal-parallel').value = '0';
    document.getElementById('modal-claude-mode').textContent = claudeMode.toUpperCase() + ' (enrichment: ' + enrichSel + ')';
    document.getElementById('modal-dry-run').textContent = dryRun ? 'Yes (no files modified)' : 'No (files will be written)';

    // Show modal
    confirmModal.classList.add('visible');

    // Wire launch button (replace handler to avoid duplicates)
    modalLaunch.onclick = function() {
      var targetDir = document.getElementById('modal-target-dir').value || 'adh-web';
      var parallel = document.getElementById('modal-parallel').value || '1';
      launchMigration(batch, targetDir, parallel, claudeMode, dryRun, btnMigrate, false);
    };
  });

  // ─── Migration Auto (skip modal, launch immediately) ─────────
  btnMigrateAuto.addEventListener('click', function() {
    var batch = batchSelect.value;
    if (!batch) { showPanel('Erreur', 'S\u00e9lectionnez un batch d\'abord'); return; }
    var enrichSel = document.getElementById('sel-enrich').value || 'none';
    var claudeMode = enrichSel === 'claude' ? 'api' : 'cli';
    var dryRun = chkDry.checked;
    launchMigration(batch, 'adh-web', '0', claudeMode, dryRun, btnMigrateAuto, true);
  });

  // ─── Reconnect on page load if migration is active ───────────
  fetch('/api/migrate/active').then(function(r) { return r.json(); }).then(function(state) {
    if (!state.running) return;

    var isDone = !state.running;
    showMigrateOverlay('Migrate: ' + state.batch + ' [' + state.mode.toUpperCase() + ']');
    mpDryBadge.style.display = state.dryRun ? 'inline-block' : 'none';
    migrateAbortBtn.style.display = isDone ? 'none' : 'inline-block';
    setLoading(btnMigrate, !isDone);

    // Set programList first so grid builds during replay
    if (state.programList && state.programList.length) {
      migrateState.programList = state.programList;
    }
    migrateState.migrationStart = state.startedAt;
    migrateState.totalProgs = state.totalPrograms;
    migrateState.doneProgs = 0;

    // Replay buffered events through central dispatch
    state.events.forEach(function(msg) {
      processMigrateEvent(msg);
    });

    // Sync done count from server state (replay already set doneProgs/failedProgs)
    updateModuleProgress(migrateState.doneProgs, state.totalPrograms);

    if (isDone) {
      var elapsed = document.getElementById('mp-elapsed');
      if (elapsed) elapsed.textContent = 'Completed';
      if (migrateState.failedProgs > 0) {
        if (migrateBadge) { migrateBadge.textContent = migrateState.doneProgs + '/' + state.totalPrograms; migrateBadge.style.background = '#f59e0b'; }
      } else {
        if (migrateBadge) { migrateBadge.textContent = 'Done'; migrateBadge.style.background = 'var(--green)'; }
      }
      return;
    }

    // Live elapsed timer
    migrateState.elapsedTid = startElapsedTimer(state.startedAt);
    var lastEventCount = state.events.length;

    // Poll for updates every 3s
    var pollTid = setInterval(function() {
      fetch('/api/migrate/active').then(function(r) { return r.json(); }).then(function(s) {
        // Process new events only
        for (var i = lastEventCount; i < s.events.length; i++) {
          processMigrateEvent(s.events[i]);
        }
        lastEventCount = s.events.length;

        if (!s.running) {
          clearInterval(pollTid);
          clearInterval(migrateState.elapsedTid);
          setLoading(btnMigrate, false);
          var elapsed = document.getElementById('mp-elapsed');
          if (elapsed) elapsed.textContent = 'Total: ' + formatElapsed(Date.now() - s.startedAt);
          var bar = document.getElementById('mp-module-bar');
          if (bar) bar.style.width = '100%';
          if (migrateBadge) { migrateBadge.textContent = 'Done'; migrateBadge.style.background = 'var(--green)'; }
        }
      });
    }, 3000);
  }).catch(function() { /* server may not support this endpoint yet */ });
})();

// ─── Help button (outside server-dependent code) ──────────────────
(function() {
  var btnHelp = document.getElementById('btn-help');
  if (btnHelp) {
    btnHelp.addEventListener('click', function() {
      var docSection = document.getElementById('documentation-section');
      if (docSection) {
        docSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  }
})();

// Documentation tabs management
(function() {
  const docTabs = document.querySelectorAll('.doc-tab');
  const docContents = document.querySelectorAll('.doc-content');

  docTabs.forEach(tab => {
    tab.addEventListener('click', function() {
      const targetTab = this.getAttribute('data-doc-tab');

      // Remove active from all tabs and contents
      docTabs.forEach(t => t.classList.remove('active'));
      docContents.forEach(c => c.classList.remove('active'));

      // Add active to clicked tab and corresponding content
      this.classList.add('active');
      const targetContent = document.querySelector(`[data-doc-content="${targetTab}"]`);
      if (targetContent) {
        targetContent.classList.add('active');
      }
    });
  });
})();

</script>
</body>
</html>