Generate Vitest component tests for "MoyenPaiementPage".

RULES (MANDATORY):
- Use import aliases: @/ for src root (e.g. @/stores/..., @/types/...)
- NEVER use `any` type - use `unknown` or precise types
- Tailwind v4 classes for styling (no tailwind.config.js)
- Arrow functions everywhere (no function declarations)
- `as const` instead of TypeScript enum
- verbatimModuleSyntax is enabled: use `import type { X }` ONLY for types/interfaces, use `import { X }` for values/consts
- File must be COMPLETE and ready to write - NO placeholders, NO TODOs, NO "// implement here"
- NO comments except for genuinely complex logic
- Output ONLY the code inside a single markdown code block (```typescript ... ``` or ```tsx ... ```)

SHARED INFRASTRUCTURE (use these exact imports):
- Data source toggle: `import { useDataSourceStore } from "@/stores/dataSourceStore"` (has .getState().isRealApi)
- API client: `import { apiClient } from "@/services/api/apiClient"` and `import type { ApiResponse } from "@/services/api/apiClient"`
- Screen layout: `import { ScreenLayout } from "@/components/layout"` (wrapper with sidebar, takes children + className)
- UI components: `import { Button, Dialog, Input } from "@/components/ui"`
- cn utility: `import { cn } from "@/lib/utils"`

TEST REQUIREMENTS:
- Use @vitest-environment jsdom
- import { render, screen, fireEvent, waitFor } from "@testing-library/react"
- Mock the store with vi.mock()
- CRITICAL: import the page component using @/ alias: import { MoyenPaiementPage } from "@/pages/MoyenPaiementPage"
- Place vi.mock() calls BEFORE the page import (vitest hoisting)
- Test: renders without crashing
- Test: displays loading state
- Test: displays data when loaded
- Test: handles user interactions (clicks, form submits)
- Test: displays error state

PAGE COMPONENT:
import { useState, useEffect, useCallback } from 'react';
import { useNavigate } from 'react-router-dom';
import { ScreenLayout } from '@/components/layout';
import { Button, Input, Dialog } from '@/components/ui';
import { useMoyenPaiementStore } from '@/stores/moyenPaiementStore';
import { useAuthStore } from '@/stores';
import type { TypeDevise, ClasseMOP, MoyenPaiement } from '@/types/moyenPaiement';
import { cn } from '@/lib/utils';

type Phase = 'lookup' | 'list';

export function MoyenPaiementPage() {
  const navigate = useNavigate();
  const user = useAuthStore((s) => s.user);

  const moyensPaiement = useMoyenPaiementStore((s) => s.moyensPaiement);
  const selectedMOP = useMoyenPaiementStore((s) => s.selectedMOP);
  const isLoading = useMoyenPaiementStore((s) => s.isLoading);
  const error = useMoyenPaiementStore((s) => s.error);
  const getMOPInfo = useMoyenPaiementStore((s) => s.getMOPInfo);
  const checkMOPExists = useMoyenPaiementStore((s) => s.checkMOPExists);
  const getMOPByCode = useMoyenPaiementStore((s) => s.getMOPByCode);
  const setSelectedMOP = useMoyenPaiementStore((s) => s.setSelectedMOP);
  const reset = useMoyenPaiementStore((s) => s.reset);

  const [phase, setPhase] = useState<Phase>('lookup');
  const [codeMOP, setCodeMOP] = useState('');
  const [typeDevise, setTypeDevise] = useState<TypeDevise>('UNI');
  const [searchResult, setSearchResult] = useState<{
    classe: ClasseMOP;
    libelle: string;
    existe: boolean;
  } | null>(null);
  const [showInfoDialog, setShowInfoDialog] = useState(false);

  useEffect(() => {
    return () => reset();
  }, [reset]);

  const handleLookup = useCallback(async () => {
    if (!codeMOP.trim()) {
      return;
    }

    const result = await getMOPInfo(codeMOP.trim(), typeDevise);
    setSearchResult(result);
    setShowInfoDialog(true);
  }, [codeMOP, typeDevise, getMOPInfo]);

  const handleCheckExists = useCallback(async () => {
    if (!codeMOP.trim()) {
      return;
    }

    const exists = await checkMOPExists(codeMOP.trim(), 'ADH');
    setSearchResult({
      classe: 'UNI',
      libelle: exists ? 'MOP existe' : 'MOP introuvable',
      existe: exists,
    });
    setShowInfoDialog(true);
  }, [codeMOP, checkMOPExists]);

  const handleGetByCode = useCallback(async () => {
    if (!codeMOP.trim()) {
      return;
    }

    const mop = await getMOPByCode(codeMOP.trim());
    if (mop) {
      setSelectedMOP(mop);
      setSearchResult({
        classe: mop.classe,
        libelle: mop.libelle,
        existe: true,
      });
      setShowInfoDialog(true);
    }
  }, [codeMOP, getMOPByCode, setSelectedMOP]);

  const handleBack = () => {
    if (phase === 'list') {
      setPhase('lookup');
    } else {
      navigate('/caisse/menu');
    }
  };

  const renderLookupPhase = () => (
    <>
      <div className="bg-surface border border-border rounded-md p-6 space-y-4">
        <div className="space-y-2">
          <label className="text-sm font-medium text-on-surface">
            Code Moyen de Paiement
          </label>
          <Input
            value={codeMOP}
            onChange={(e) => setCodeMOP(e.target.value.toUpperCase())}
            placeholder="Ex: CB, ESP, CHQ..."
            maxLength={10}
            className="max-w-xs"
          />
        </div>

        <div className="space-y-2">
          <label className="text-sm font-medium text-on-surface">
            Type de Devise
          </label>
          <div className="flex gap-4">
            <label className="flex items-center gap-2">
              <input
                type="radio"
                name="typeDevise"
                value="UNI"
                checked={typeDevise === 'UNI'}
                onChange={(e) => setTypeDevise(e.target.value as TypeDevise)}
                className="w-4 h-4"
              />
              <span className="text-sm">UNI (Devise unique)</span>
            </label>
            <label className="flex items-center gap-2">
              <input
                type="radio"
                name="typeDevise"
                value="BI"
                checked={typeDevise === 'BI'}
                onChange={(e) => setTypeDevise(e.target.value as TypeDevise)}
                className="w-4 h-4"
              />
              <span className="text-sm">BI (Bi-devise)</span>
            </label>
          </div>
        </div>

        <div className="flex gap-3 pt-4">
          <Button
            onClick={handleLookup}
            disabled={!codeMOP.trim() || isLoading}
            className="bg-primary text-white hover:bg-primary-dark"
          >
            {isLoading ? 'Recherche...' : 'Récupérer Info'}
          </Button>
          <Button
            onClick={handleCheckExists}
            disabled={!codeMOP.trim() || isLoading}
            variant="secondary"
          >
            Vérifier Existence
          </Button>
          <Button
            onClick={handleGetByCode}
            disabled={!codeMOP.trim() || isLoading}
            variant="secondary"
          >
            Recherche Complète
          </Button>
        </div>
      </div>

      {moyensPaiement.length > 0 && (
        <div className="bg-surface border border-border rounded-md p-4">
          <h3 className="text-sm font-semibold mb-3">Moyens de paiement disponibles</h3>
          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
            {moyensPaiement.map((mop) => (
              <button
                key={mop.code}
                onClick={() => {
                  setCodeMOP(mop.code);
                  setTypeDevise(mop.typeDevise);
                }}
                className="px-3 py-2 text-left border border-border rounded hover:bg-surface-hover text-sm"
              >
                <div className="font-medium">{mop.code}</div>
                <div className="text-xs text-on-surface-muted truncate">
                  {mop.libelle}
                </div>
              </button>
            ))}
          </div>
        </div>
      )}
    </>
  );

  return (
    <ScreenLayout>
      <div className="space-y-6 max-w-4xl mx-auto">
        <div className="flex items-center justify-between">
          <div>
            <h2 className="text-xl font-semibold">Moyen de Paiement</h2>
            <p className="text-on-surface-muted text-sm mt-1">
              {phase === 'lookup'
                ? 'Rechercher les informations d\'un moyen de paiement'
                : 'Liste des moyens de paiement'}
            </p>
          </div>
          {user && (
            <span className="text-xs text-on-surface-muted">
              {user.prenom} {user.nom}
            </span>
          )}
        </div>

        {error && (
          <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm">
            {error}
          </div>
        )}

        {phase === 'lookup' && renderLookupPhase()}

        <div className="flex justify-start">
          <button
            onClick={handleBack}
            className="px-4 py-2 border border-border rounded-md text-on-surface hover:bg-surface-hover"
          >
            {phase === 'list' ? 'Retour à la recherche' : 'Retour au menu'}
          </button>
        </div>

        <Dialog open={showInfoDialog} onOpenChange={setShowInfoDialog}>
          <div className="space-y-4">
            <h3 className="text-lg font-semibold">
              Informations Moyen de Paiement
            </h3>

            {searchResult && (
              <div className="space-y-3">
                <div className="flex items-center gap-2">
                  <span
                    className={cn(
                      'px-2 py-1 rounded text-xs font-medium',
                      searchResult.existe
                        ? 'bg-green-100 text-green-800'
                        : 'bg-red-100 text-red-800',
                    )}
                  >
                    {searchResult.existe ? 'Trouvé' : 'Non trouvé'}
                  </span>
                </div>

                {searchResult.existe && (
                  <>
                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <div className="text-xs text-on-surface-muted mb-1">
                          Code
                        </div>
                        <div className="font-medium">{codeMOP}</div>
                      </div>
                      <div>
                        <div className="text-xs text-on-surface-muted mb-1">
                          Classe
                        </div>
                        <div className="font-medium">{searchResult.classe}</div>
                      </div>
                    </div>

                    <div>
                      <div className="text-xs text-on-surface-muted mb-1">
                        Libellé
                      </div>
                      <div className="font-medium">{searchResult.libelle}</div>
                    </div>

                    {selectedMOP && (
                      <div>
                        <div className="text-xs text-on-surface-muted mb-1">
                          Type de Devise
                        </div>
                        <div className="font-medium">
                          {selectedMOP.typeDevise === 'UNI'
                            ? 'Devise unique'
                            : 'Bi-devise'}
                        </div>
                      </div>
                    )}
                  </>
                )}

                {!searchResult.existe && (
                  <div className="text-sm text-on-surface-muted">
                    Le moyen de paiement {codeMOP} n'a pas été trouvé dans le
                    référentiel.
                  </div>
                )}
              </div>
            )}

            <div className="flex justify-end gap-3 pt-4">
              <Button
                onClick={() => setShowInfoDialog(false)}
                variant="secondary"
              >
                Fermer
              </Button>
            </div>
          </div>
        </Dialog>
      </div>
    </ScreenLayout>
  );
}

TYPES:
import type { ApiResponse } from "@/services/api/apiClient";

export type TypeDevise = "UNI" | "BI";
export type ClasseMOP = "UNI" | "BI" | "TRANSF" | "CHQ";

export interface MoyenPaiement {
  code: string;
  libelle: string;
  classe: ClasseMOP;
  typeDevise: TypeDevise;
}

export interface MoyenReglement {
  code: string;
  libelle: string;
}

export interface MOPInfo {
  classe: ClasseMOP;
  libelle: string;
  existe: boolean;
}

export interface MOPExistsResponse {
  existe: boolean;
}

export interface GetMOPInfoRequest {
  code: string;
  typeDevise?: TypeDevise;
}

export interface GetMOPInfoResponse extends ApiResponse {
  data: MOPInfo;
}

export interface CheckMOPExistsRequest {
  code: string;
  societe: string;
}

export interface CheckMOPExistsResponse extends ApiResponse {
  data: MOPExistsResponse;
}

export interface GetMOPByCodeRequest {
  code: string;
}

export interface GetMOPByCodeResponse extends ApiResponse {
  data: MoyenPaiement | null;
}

export interface MoyenPaiementState {
  moyensPaiement: MoyenPaiement[];
  selectedMOP: MoyenPaiement | null;
  isLoading: boolean;
  error: string | null;
}

export interface MoyenPaiementActions {
  getMOPInfo: (
    codeMOP: string,
    typeDevise: TypeDevise
  ) => Promise<{ classe: ClasseMOP; libelle: string; existe: boolean }>;
  checkMOPExists: (codeMOP: string, societe: string) => Promise<boolean>;
  getMOPByCode: (codeMOP: string) => Promise<MoyenPaiement | null>;
  setMoyensPaiement: (moyens: MoyenPaiement[]) => void;
  setSelectedMOP: (mop: MoyenPaiement | null) => void;
  setIsLoading: (isLoading: boolean) => void;
  setError: (error: string | null) => void;
  reset: () => void;
}

export type MoyenPaiementStore = MoyenPaiementState & MoyenPaiementActions;

UI SECTIONS:
[
  {
    "name": "integration",
    "controls": [
      "Utilisé par les écrans de vente pour afficher le libellé du MOP",
      "Utilisé par les générateurs de tickets pour formatter les moyens de paiement",
      "Utilisé par les écrans de transaction pour valider les MOP saisis"
    ]
  }
]