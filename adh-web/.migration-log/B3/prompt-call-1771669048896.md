Generate Vitest component tests for "RaisonsUtilisationPage".

RULES (MANDATORY):
- Use import aliases: @/ for src root (e.g. @/stores/..., @/types/...)
- NEVER use `any` type - use `unknown` or precise types
- Tailwind v4 classes for styling (no tailwind.config.js)
- Arrow functions everywhere (no function declarations)
- `as const` instead of TypeScript enum
- verbatimModuleSyntax is enabled: use `import type { X }` ONLY for types/interfaces, use `import { X }` for values/consts
- File must be COMPLETE and ready to write - NO placeholders, NO TODOs, NO "// implement here"
- NO comments except for genuinely complex logic
- Output ONLY the code inside a single markdown code block (```typescript ... ``` or ```tsx ... ```)

SHARED INFRASTRUCTURE (use these exact imports):
- Data source toggle: `import { useDataSourceStore } from "@/stores/dataSourceStore"` (has .getState().isRealApi)
- API client: `import { apiClient } from "@/services/api/apiClient"` and `import type { ApiResponse } from "@/services/api/apiClient"`
- Screen layout: `import { ScreenLayout } from "@/components/layout"` (wrapper with sidebar, takes children + className)
- UI components: `import { Button, Dialog, Input } from "@/components/ui"`
- cn utility: `import { cn } from "@/lib/utils"`

TEST REQUIREMENTS:
- Use @vitest-environment jsdom
- import { render, screen, fireEvent, waitFor } from "@testing-library/react"
- Mock the store with vi.mock()
- CRITICAL: import the page component using @/ alias: import { RaisonsUtilisationPage } from "@/pages/RaisonsUtilisationPage"
- Place vi.mock() calls BEFORE the page import (vitest hoisting)
- Test: renders without crashing
- Test: displays loading state
- Test: displays data when loaded
- Test: handles user interactions (clicks, form submits)
- Test: displays error state

PAGE COMPONENT:
import { useState, useEffect, useCallback } from 'react';
import { ScreenLayout } from '@/components/layout';
import { Dialog, Button, Input } from '@/components/ui';
import { useRaisonsUtilisationStore } from '@/stores/raisonsUtilisationStore';
import { cn } from '@/lib/utils';

const MAX_COMMENTAIRE_LENGTH = 100;

export function RaisonsUtilisationPage() {
  const raisons = useRaisonsUtilisationStore((s) => s.raisons);
  const selectedRaisonPrimaire = useRaisonsUtilisationStore((s) => s.selectedRaisonPrimaire);
  const selectedRaisonSecondaire = useRaisonsUtilisationStore((s) => s.selectedRaisonSecondaire);
  const commentaireSaisi = useRaisonsUtilisationStore((s) => s.commentaireSaisi);
  const confirmation = useRaisonsUtilisationStore((s) => s.confirmation);
  const isLoading = useRaisonsUtilisationStore((s) => s.isLoading);
  const error = useRaisonsUtilisationStore((s) => s.error);
  
  const loadRaisonsUtilisation = useRaisonsUtilisationStore((s) => s.loadRaisonsUtilisation);
  const selectRaisonPrimaire = useRaisonsUtilisationStore((s) => s.selectRaisonPrimaire);
  const selectRaisonSecondaire = useRaisonsUtilisationStore((s) => s.selectRaisonSecondaire);
  const validerSelection = useRaisonsUtilisationStore((s) => s.validerSelection);
  const abandonner = useRaisonsUtilisationStore((s) => s.abandonner);
  const updateCommentaire = useRaisonsUtilisationStore((s) => s.updateCommentaire);
  const reset = useRaisonsUtilisationStore((s) => s.reset);

  const [open, setOpen] = useState(true);

  useEffect(() => {
    loadRaisonsUtilisation();
    return () => reset();
  }, [loadRaisonsUtilisation, reset]);

  useEffect(() => {
    if (confirmation) {
      setOpen(false);
    }
  }, [confirmation]);

  const handleRowClick = useCallback(
    async (idPrimaire: number) => {
      await selectRaisonPrimaire(idPrimaire);
    },
    [selectRaisonPrimaire],
  );

  const handleSecondarySelect = useCallback(
    async (idSecondaire: number) => {
      await selectRaisonSecondaire(idSecondaire);
    },
    [selectRaisonSecondaire],
  );

  const handleValider = useCallback(async () => {
    if (selectedRaisonPrimaire === null) {
      return;
    }
    await validerSelection();
  }, [selectedRaisonPrimaire, validerSelection]);

  const handleAbandonner = useCallback(async () => {
    await abandonner();
    setOpen(false);
  }, [abandonner]);

  const handleCommentaireChange = useCallback(
    (value: string) => {
      if (value.length <= MAX_COMMENTAIRE_LENGTH) {
        updateCommentaire(value);
      }
    },
    [updateCommentaire],
  );

  const selectedPrimaryRaison = raisons.find((r) => r.idPrimaire === selectedRaisonPrimaire);
  const showSecondaryGrid = selectedPrimaryRaison?.existeRaisonSecondaire === true;
  const secondaryRaisons = showSecondaryGrid
    ? raisons.filter((r) => r.idPrimaire === selectedRaisonPrimaire && r.idSecondaire !== null)
    : [];

  const canValidate = selectedRaisonPrimaire !== null && (
    !selectedPrimaryRaison?.existeRaisonSecondaire || selectedRaisonSecondaire !== null
  );

  return (
    <ScreenLayout>
      <Dialog open={open} onClose={handleAbandonner}>
        <div className="bg-surface rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
          <div className="px-6 py-4 border-b border-border">
            <h2 className="text-xl font-semibold text-on-surface">
              Raisons d'utilisation du compte
            </h2>
          </div>

          <div className="flex-1 overflow-y-auto px-6 py-4 space-y-4">
            {error && (
              <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm">
                {error}
              </div>
            )}

            {isLoading ? (
              <div className="flex justify-center items-center py-12">
                <div className="text-on-surface-muted">Chargement...</div>
              </div>
            ) : (
              <>
                <div className="border border-border rounded-md overflow-hidden">
                  <div className="bg-surface-hover px-4 py-2 grid grid-cols-[100px_100px_1fr] gap-4 border-b border-border font-medium text-sm">
                    <div>Code Primaire</div>
                    <div>Code Secondaire</div>
                    <div>Libellé</div>
                  </div>
                  <div className="divide-y divide-border max-h-60 overflow-y-auto">
                    {raisons
                      .filter((r) => r.idSecondaire === null || !r.existeRaisonSecondaire)
                      .map((raison) => (
                        <button
                          key={raison.idPrimaire}
                          onClick={() => handleRowClick(raison.idPrimaire)}
                          className={cn(
                            'w-full px-4 py-2 grid grid-cols-[100px_100px_1fr] gap-4 text-left hover:bg-surface-hover transition-colors text-sm',
                            selectedRaisonPrimaire === raison.idPrimaire && 'bg-primary/10',
                          )}
                        >
                          <div>{raison.idPrimaire}</div>
                          <div>{raison.idSecondaire ?? '-'}</div>
                          <div>{raison.commentaire}</div>
                        </button>
                      ))}
                    {raisons.filter((r) => r.idSecondaire === null || !r.existeRaisonSecondaire).length === 0 && (
                      <div className="px-4 py-8 text-center text-on-surface-muted text-sm">
                        Aucune raison disponible
                      </div>
                    )}
                  </div>
                </div>

                {showSecondaryGrid && (
                  <div className="border border-border rounded-md overflow-hidden">
                    <div className="bg-surface-hover px-4 py-2 font-medium text-sm border-b border-border">
                      Raisons secondaires
                    </div>
                    <div className="divide-y divide-border max-h-40 overflow-y-auto">
                      {secondaryRaisons.map((raison) => (
                        <button
                          key={raison.idSecondaire}
                          onClick={() => raison.idSecondaire !== null && handleSecondarySelect(raison.idSecondaire)}
                          className={cn(
                            'w-full px-4 py-2 grid grid-cols-[100px_1fr] gap-4 text-left hover:bg-surface-hover transition-colors text-sm',
                            selectedRaisonSecondaire === raison.idSecondaire && 'bg-primary/10',
                          )}
                        >
                          <div>{raison.idSecondaire}</div>
                          <div>{raison.commentaire}</div>
                        </button>
                      ))}
                      {secondaryRaisons.length === 0 && (
                        <div className="px-4 py-4 text-center text-on-surface-muted text-sm">
                          Aucune raison secondaire disponible
                        </div>
                      )}
                    </div>
                  </div>
                )}

                <div className="space-y-2">
                  <label htmlFor="commentaire" className="block text-sm font-medium text-on-surface">
                    Commentaire (optionnel)
                  </label>
                  <Input
                    id="commentaire"
                    value={commentaireSaisi}
                    onChange={(e) => handleCommentaireChange(e.target.value)}
                    placeholder="Saisir un commentaire..."
                    maxLength={MAX_COMMENTAIRE_LENGTH}
                  />
                  <div className="flex justify-end text-xs text-on-surface-muted">
                    {commentaireSaisi.length} / {MAX_COMMENTAIRE_LENGTH}
                  </div>
                </div>
              </>
            )}
          </div>

          <div className="px-6 py-4 border-t border-border flex justify-end gap-3">
            <Button variant="secondary" onClick={handleAbandonner}>
              Abandonner
            </Button>
            <Button variant="primary" onClick={handleValider} disabled={!canValidate || isLoading}>
              Valider
            </Button>
          </div>
        </div>
      </Dialog>
    </ScreenLayout>
  );
}

TYPES:
import type { ApiResponse } from "@/services/api/apiClient";

export interface RaisonUtilisation {
  idPrimaire: number;
  idSecondaire: number | null;
  commentaire: string;
  existeRaisonSecondaire: boolean;
}

export interface RaisonsUtilisationState {
  raisons: RaisonUtilisation[];
  selectedRaisonPrimaire: number | null;
  selectedRaisonSecondaire: number | null;
  commentaireSaisi: string;
  confirmation: boolean;
  retourRaison: boolean;
  isLoading: boolean;
  error: string | null;

  loadRaisonsUtilisation: (serviceCode?: number) => Promise<void>;
  selectRaisonPrimaire: (idPrimaire: number) => Promise<void>;
  selectRaisonSecondaire: (idSecondaire: number) => Promise<void>;
  validerSelection: () => Promise<void>;
  abandonner: () => Promise<void>;
  updateCommentaire: (commentaire: string) => void;
  reset: () => void;
}

export interface GetRaisonsUtilisationRequest {
  serviceCode?: number;
}

export interface GetRaisonsUtilisationResponse extends ApiResponse {
  data: RaisonUtilisation[];
}

export interface SelectRaisonPrimaireRequest {
  idPrimaire: number;
}

export interface SelectRaisonSecondaireRequest {
  idSecondaire: number;
}

export interface ValiderSelectionRequest {
  commentaire: string;
  selectedRaisonPrimaire: number;
  selectedRaisonSecondaire: number | null;
}

export interface ValiderSelectionResponse extends ApiResponse {
  data: {
    idPrimaire: number;
    idSecondaire: number | null;
    commentaire: string;
  };
}

export const RAISON_UTILISATION_MOCK = [
  {
    idPrimaire: 1,
    idSecondaire: null,
    commentaire: "Paiement service bar",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 2,
    idSecondaire: null,
    commentaire: "Paiement restaurant",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 3,
    idSecondaire: null,
    commentaire: "Paiement boutique",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 4,
    idSecondaire: null,
    commentaire: "Caution",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 5,
    idSecondaire: null,
    commentaire: "Dépôt espèces",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 6,
    idSecondaire: 61,
    commentaire: "Retrait espèces",
    existeRaisonSecondaire: true,
  },
  {
    idPrimaire: 7,
    idSecondaire: null,
    commentaire: "Frais divers",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 8,
    idSecondaire: null,
    commentaire: "Remboursement",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 9,
    idSecondaire: null,
    commentaire: "Ajustement compte",
    existeRaisonSecondaire: false,
  },
  {
    idPrimaire: 10,
    idSecondaire: null,
    commentaire: "Autre motif",
    existeRaisonSecondaire: false,
  },
] as const satisfies readonly RaisonUtilisation[];

UI SECTIONS:
[
  {
    "name": "header",
    "controls": [
      "Dialog title: 'Raisons d'utilisation du compte'"
    ]
  },
  {
    "name": "mainGrid",
    "controls": [
      "DataGrid with columns: Code Primaire, Code Secondaire, Libellé",
      "Row selection (single)",
      "Sort by Code Primaire ASC"
    ]
  },
  {
    "name": "commentaireSection",
    "controls": [
      "Text input for commentaire (optional)",
      "Character limit display"
    ]
  },
  {
    "name": "footer",
    "controls": [
      "Button: Valider (primary)",
      "Button: Abandonner (secondary)"
    ]
  }
]