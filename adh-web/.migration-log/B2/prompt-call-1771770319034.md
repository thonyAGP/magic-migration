Generate Vitest unit tests for the "sessionDetailStore".

RULES (MANDATORY):
- Use import aliases: @/ for src root (e.g. @/stores/..., @/types/...)
- NEVER use `any` type - use `unknown` or precise types
- Tailwind v4 classes for styling (no tailwind.config.js)
- Arrow functions everywhere (no function declarations)
- `as const` instead of TypeScript enum
- verbatimModuleSyntax is enabled: use `import type { X }` ONLY for types/interfaces, use `import { X }` for values/consts
- File must be COMPLETE and ready to write - NO placeholders, NO TODOs, NO "// implement here"
- NO comments except for genuinely complex logic
- Output ONLY the code inside a single markdown code block (```typescript ... ``` or ```tsx ... ```)

SHARED INFRASTRUCTURE (use these exact imports):
- Data source toggle: `import { useDataSourceStore } from "@/stores/dataSourceStore"` (has .getState().isRealApi)
- API client: `import { apiClient } from "@/services/api/apiClient"` and `import type { ApiResponse } from "@/services/api/apiClient"`
- Screen layout: `import { ScreenLayout } from "@/components/layout"` (wrapper with sidebar, takes children + className)
- UI components: `import { Button, Dialog, Input } from "@/components/ui"`
- cn utility: `import { cn } from "@/lib/utils"`

TEST REQUIREMENTS:
- Use @vitest-environment jsdom
- import { describe, it, expect, beforeEach, vi } from "vitest"
- vi.mock() for API service
- beforeEach: reset store state
- AAA pattern (Arrange, Act, Assert)
- Test EACH action: success path + error path + loading state
- Mock data as constants at top of file
- Test business rules explicitly

STORE TO TEST:
import { create } from 'zustand';
import type {
  LogSessionDetailRequest,
  LogSessionDetailResponse,
  SessionDetailState,
  SessionDetailActions,
  SessionDetailStore,
} from '@/types/sessionDetail';
import { apiClient } from '@/services/api/apiClient';
import { useDataSourceStore } from '@/stores/dataSourceStore';

const initialState: SessionDetailState = {
  isLoading: false,
  error: null,
};

export const useSessionDetailStore = create<SessionDetailStore>()((set) => ({
  ...initialState,

  logSessionDetail: async (request: LogSessionDetailRequest) => {
    const { isRealApi } = useDataSourceStore.getState();
    set({ isLoading: true, error: null });

    if (!isRealApi) {
      set({ isLoading: false });
      return;
    }

    try {
      const payload = {
        societe: request.societe,
        deviseLocale: request.deviseLocale,
        uniBi: request.uniBi,
        chronoSession: request.chronoSession,
        quand: request.quand,
        quoi: request.quoi,
        type: request.type,
        montant: request.montant,
        montantMonnaie: request.montantMonnaie,
        montantProduits: request.montantProduits,
        montantCartes: request.montantCartes,
        montantCheques: request.montantCheques,
        montantOd: request.montantOd,
        nbreDevises: request.nbreDevises,
        commentaireEcart: request.commentaireEcart,
        commentaireEcartDevise: request.commentaireEcartDevise,
        ouvertureAuto: request.ouvertureAuto ? 'O' : '',
      };

      const response = await apiClient.post<LogSessionDetailResponse>(
        '/api/session-detail/log',
        payload,
      );

      if (!response.data.success) {
        throw new Error(response.data.error ?? 'Erreur lors de la journalisation du détail');
      }
    } catch (e: unknown) {
      const message = e instanceof Error ? e.message : 'Erreur journalisation détail session';
      set({ error: message });
      throw e;
    } finally {
      set({ isLoading: false });
    }
  },

  setLoading: (loading: boolean) => {
    set({ isLoading: loading });
  },

  setError: (error: string | null) => {
    set({ error });
  },

  reset: () => set({ ...initialState }),
}));

TYPES:
import type { ApiResponse } from "@/services/api/apiClient";

export type SessionDetailQuandType = 'O' | 'F';
export type SessionDetailActionType = 'E' | 'V' | 'I';

export interface SessionDetailLog {
  societe: string;
  deviseLocale: string;
  uniBi: string;
  chronoSession: number;
  quand: SessionDetailQuandType;
  quoi: string;
  type: SessionDetailActionType;
  montant: number | null;
  montantMonnaie: number | null;
  montantProduits: number | null;
  montantCartes: number | null;
  montantCheques: number | null;
  montantOd: number | null;
  nbreDevises: number | null;
  commentaireEcart: string | null;
  ouvertureAuto: string | null;
}

export interface LogSessionDetailRequest {
  societe: string;
  deviseLocale: string;
  uniBi: string;
  chronoSession: number;
  quand: SessionDetailQuandType;
  quoi: string;
  type: SessionDetailActionType;
  montant: number;
  montantMonnaie: number;
  montantProduits: number;
  montantCartes: number;
  montantCheques: number;
  montantOd: number;
  nbreDevises: number;
  commentaireEcart: string;
  commentaireEcartDevise: string;
  ouvertureAuto: boolean;
}

export type LogSessionDetailResponse = ApiResponse<void>;

export interface SessionDetailState {
  isLoading: boolean;
  error: string | null;
}

export interface SessionDetailActions {
  logSessionDetail: (request: LogSessionDetailRequest) => Promise<void>;
  setLoading: (loading: boolean) => void;
  setError: (error: string | null) => void;
  reset: () => void;
}

export type SessionDetailStore = SessionDetailState & SessionDetailActions;

ACTIONS TO COVER:
[
  {
    "name": "logSessionDetail",
    "params": [
      "societe: string",
      "deviseLocale: string",
      "uniBi: string",
      "chronoSession: number",
      "quand: 'O'|'F'",
      "quoi: string",
      "type: 'E'|'V'|'I'",
      "montant: number",
      "montantMonnaie: number",
      "montantProduits: number",
      "montantCartes: number",
      "montantCheques: number",
      "montantOd: number",
      "nbreDevises: number",
      "commentaireEcart: string",
      "commentaireEcartDevise: string",
      "ouvertureAuto: boolean"
    ],
    "businessRules": [
      "RM-001: If type='E' → write to histo_sessions_caisse_devise",
      "RM-002: If nbreDevises>0 → write devise detail rows",
      "RM-003: If type='V' → write to histo_sessions_caisse_article",
      "RM-004: If type='V' AND montantProduits>0 → write article detail",
      "RM-005: If quand='O' AND type='I' → mark as initial opening",
      "RM-006: ouvertureAuto → set to 'O' else empty string"
    ],
    "returns": "Promise<void>"
  }
]